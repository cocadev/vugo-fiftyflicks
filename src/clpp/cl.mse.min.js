(function(){var g={}; var _ = _ || {};
var f=function(window){/*

 Copyright 2016 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
var tu,uu,vu,wu,yu,zu,Bu,Cu,Du,Eu,Fu,Gu,Hu,Iu,Ku,Lu,Mu,Nu,Ou,Pu,Qu,Ru,Su,Tu,Uu,Vu,Wu,Xu,Zu,$u,av,bv,cv,dv,ev,fv,gv,iv,jv,kv,lv,nv,mv,ov,qv,rv,sv,uv,vv,wv,xv,yv,Av,Bv,Cv,Ev,Dv,Gv,Hv,Fv,Kv,Iv,Lv,Mv,Jv,Ov,Qv,Sv,Pv,Tv,Rv,Uv,Xv,Yv,Zv,Vv,Wv,$v,aw,bw,cw,dw,ew,gw,iw,hw,jw,nw,kw,Kw,Lw,Mw,Ow,Nw,Qw,Sw,Rw,Pw,Tw,Vw,Uw,Ww,Xw,$w,Zw,ax,bx,cx,dx,fx,Yw,gx,hx,ix,jx,kx,lx,mx,ox,px,nx,yx,xx,vx,zx,Ax,Bx,Dx,Ex,Gx,Fx,Hx,Kx,Ix,Jx,Mx,Lx,Nx,Ox,Rx,Tx,Sx,Ux,Vx,Wx,Xx,Zx,$x,ay,Yx,cy,by,gy,hy,jy,fy,ey,ky,dy,iy,oy,qy,ny,ry,my,py,
ly,uy,vy,Ay,Cy,Ky,Ey,My,yy,Ny,wy,Ly,Ry,Oy,Sy,Fy,Hy,Vy,Uy,Ty,cz,az,Xy,Wy,Zy,ez,dz,$y,Qy,xy,Dy,Yy,Jy,zy,Iy,fz,gz,Py,Gy,bz,jz,kz,lz,rz,pz,oz,nz,qz,tz,xz,Fz,Rz,wz,Oz,Kz,Lz,Mz,Gz,Nz,Dz,tx,rx,ux,sx,wx,qx,Xz,Vz,Iz,Ez,Qz,Yz,Wz,Pz,Sz,sz,Hz,$z,Cz,Az,cA,Jz,Bz,bA,aA,uz,Zz,Uz,eA,yz,Tz,dA,fA,vz,gA,Yu;tu=" buffer";uu=" is being or has been set up";vu="Jumping forward";wu="MediaSource threw QuotaExceededError:";_.xu="No stream with id";yu="Not a persistent session.";zu="PatchedMediaKeysWebkit.MediaKeys.findSession_";
_.Au="Player is in ERROR state and can not switch to ";Bu="PrestoPlay TextTrack";Cu="Removing audio from variant - audio not compatible with platform";Du="Symbol(Symbol.iterator)";Eu="bufferBehind\x3d";Fu="bufferedBehind\x3d";Gu="calling onCanSwitch()...";Hu="clpp.mse.Player";Iu="currentPeriod.startTime\x3d";_.Ju="onChooseStreams_";Ku="output-restricted";Lu="presentationTime\x3d";Mu="reference.endTime\x3d";Nu="reference.startTime\x3d";Ou="switch: Stream ";Pu="webkit-org.w3.clearkey";
Qu=function(a,b,c,d){return Promise.resolve().then(function(){if(a.o&&a.g)if(null==c||null==d)a.o.parseInit(_.J(b));else{var e={periodStart:a.w,segmentStart:c,segmentEnd:d};e=a.o.parseMedia(_.J(b),e);var f=e.cues.filter(function(g){return g.startTime>=a.h&&g.startTime<a.j});a.g.append(f,e.styles);null==a.a&&(a.a=Math.max(c,a.h));a.f=Math.min(d,a.j)}})};
Ru=function(a,b,c,d,e){var f=c+" "+d,g=new Map;b=_.t(b);for(var k=b.next();!k.done;k=b.next()){var l=k.value;k=l.stream;g.has(k)||g.set(k,new Map);g.get(k).has(f)||g.get(k).set(f,[]);l.startTime+=e;l.endTime+=e;l.startTime>=a.h&&l.startTime<a.j&&(l=new _.zg(l.startTime,l.endTime,l.text),g.get(k).get(f).push(l),k==a.A&&a.g.append([l],[]))}e=_.t(g.keys());for(f=e.next();!f.done;f=e.next())for(f=f.value,a.m.has(f)||a.m.set(f,new Map),b=_.t(g.get(f).keys()),k=b.next();!k.done;k=b.next())k=k.value,l=g.get(f).get(k),
a.m.get(f).set(k,l);a.a=null==a.a?Math.max(c,a.h):Math.min(a.a,Math.max(c,a.h));a.f=Math.max(a.f,Math.min(d,a.j))};Su=function(a,b){for(var c in a.a)b(c,a.a[c])};Tu=function(a){for(var b=a.a;_.Gj(a)&&0!==a.f.getUint8(a.a);)a.a+=1;b=a.f.buffer.slice(b,a.a);a.a+=1;return _.Tf(b)};Uu=function(a,b){return _.si("Edge/")?!0:a.L.has(b)};
Vu=function(a,b){var c=b.audio,d=b.video;if(c&&c.encrypted&&!Uu(a,_.Dg(c.mimeType,c.codecs))||d&&d.encrypted&&!Uu(a,_.Dg(d.mimeType,d.codecs)))return!1;var e=a.keySystem();return 0==b.drmInfos.length||b.drmInfos.some(function(f){return f.keySystem==e})};Wu=function(a){var b=a.ec()||!a.isLive()&&(Infinity==a.h||a.f)?0:a.D;return Math.max(0,_.ko(a)-b)};Xu=function(a,b){var c=Math.max(a.j,0);if(Infinity==a.lc)return c;var d=_.ko(a)-a.lc;d=Math.min(d+b,Wu(a));return Math.max(c,d)};
Zu=function(a,b){if(!a&&!b)return!0;if(!a||!b||a.byteLength!=b.byteLength)return!1;if(_.Rf(a)==_.Rf(b)&&(a.byteOffset||0)==(b.byteOffset||0))return!0;for(var c=_.J(a),d=_.J(b),e=_.t(Yu(a.byteLength)),f=e.next();!f.done;f=e.next())if(f=f.value,c[f]!=d[f])return!1;return!0};$u=function(a,b){for(var c in b)if(b.hasOwnProperty(c)&&b[c]===a)return c;return""};av=function(a){var b=[a.mimeType];_.Go.forEach(function(c,d){var e=a[d];e&&b.push(c+'\x3d"'+e+'"')});return b.join(";")};
bv=function(a,b){if(a===b)return!0;if(!a||!b||a.length!==b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!==b[c])return!1;return!0};cv=function(a,b){for(var c=new _.Nh(void 0,void 0===b?"total":b),d=_.t(a),e=d.next();!e.done;e=d.next())c.a.push(e.value);c.length=a.length;return c};dv=function(a,b){for(var c=null,d=_.t(a),e=d.next();!e.done;e=d.next())e=e.value,b>=e.startTime&&(c=e);return c};ev=function(a,b){for(var c=0,d=_.t(a),e=d.next();!e.done;e=d.next())c+=b(e.value)?1:0;return c};
fv=function(a,b){a=_.un(a);b=_.un(b);var c=a.split("-"),d=b.split("-");return c[0]==d[0]&&1==c.length&&2==d.length};gv=function(a){return a.language?_.un(a.language):a.audio&&a.audio.language?_.un(a.audio.language):a.video&&a.video.language?_.un(a.video.language):_.ue};
_.hv=function(a,b){for(var c=_.un(a),d=new Set,e=_.t(b),f=e.next();!f.done;f=e.next())d.add(_.un(f.value));e=_.t(d);for(f=e.next();!f.done;f=e.next())if(f=f.value,f==c)return f;e=_.t(d);for(f=e.next();!f.done;f=e.next())if(f=f.value,fv(f,c))return f;e=_.t(d);for(f=e.next();!f.done;f=e.next()){var g=f=f.value,k=c;g=_.un(g);k=_.un(k);g=g.split("-");k=k.split("-");if(2==g.length&&2==k.length&&g[0]==k[0])return f}d=_.t(d);for(f=d.next();!f.done;f=d.next())if(e=f.value,fv(c,e))return e;return null};
iv=function(){this.f=function(){};this.a=new Set};jv=function(a,b){a.f=b};
kv=function(a){var b=this;this.j=a;this.h=new Map;this.a=function(){};this.f=function(){};this.g=function(){};this.o=[{qc:null,pc:2,$b:function(c,d){return b.a(c,d)}},{qc:1,pc:2,$b:function(c,d){return b.a(c,d)}},{qc:3,pc:2,$b:function(c,d){return b.a(c,d)}},{qc:2,pc:1,$b:function(c,d){return b.f(c,d)}},{qc:2,pc:3,$b:function(c,d){return b.f(c,d)}},{qc:1,pc:3,$b:function(c,d){return b.g(c,d)}},{qc:3,pc:1,$b:function(c,d){return b.g(c,d)}}]};lv=function(a,b,c,d){a.a=b;a.f=c;a.g=d};
nv=function(a){var b=this;this.f=a;this.a=new Set;this.g=(new _.th(function(){mv(b,!1)})).Ya(.25)};mv=function(a,b){for(var c=_.t(a.a),d=c.next();!d.done;d=c.next())d.value.m(a.f.currentTime,b)};ov=function(a,b){return a.start-b.start};_.pv=function(a){this.m=a;this.log=new _.G("clpp.renditions");this.f=[];this.j=this.a=null;this.h=!1};qv=function(a){return a.f.map(function(b){return{start:b.start,end:b.end,width:b.width,height:b.height,bandwidth:b.bandwidth,rendition:b.rendition}})};
rv=function(a){a.a&&a.a.trigger(new _.M(_.ec))};sv=function(a){if(a.a){for(var b=!1,c={},d=0;d<a.f.length;d++){var e=a.f[d],f=e.width+"x"+e.height,g=c[f];if(g&&g!==e.bandwidth){b=!0;break}c[f]=e.bandwidth}b&&!a.h?(a.log.debug("Tracking timeupdates"),a.a.on(_.re,a.g,a),a.h=!0):!b&&a.h&&(a.log.debug("Stop tracking timeupdates"),a.a.off(_.re,a.g),a.h=!1)}};
uv=function(a,b,c){a.f=a.f.filter(function(d){if(d.end<=b||d.start>=c)return!1;d.start=Math.max(d.start,b);d.end=Math.min(d.end,c);return!0});a.a&&a.a.trigger(new _.M(_.He))};vv=function(a){_.kg.call(this,a);a=a.getSurface().getMedia();this.a=null;for(var b=0;b<a.textTracks.length;++b){var c=a.textTracks[b];c.mode=_.Mc;c.label===Bu&&(this.a=c)}this.a||(this.a=a.addTextTrack(_.me,Bu));this.a.mode=_.cd};
wv=function(a,b){var c=a.mode;a.mode=c==_.de?_.de:_.cd;for(var d=a.cues,e=d.length-1;0<=e;e--){var f=d[e];f&&b(f)&&a.removeCue(f)}a.mode=c};xv=function(){};yv=function(a,b,c){function d(f,g){return null==f?null==g:g.id==f}for(var e=0;e<c.length;e++)if(d(a,c[e].audio)&&d(b,c[e].video))return c[e];return null};Av=function(a,b){var c=a&&b[zv]();return function(d){return a?c.next():b[d]}};Bv=function(a){return typeof a===_.ad||"[object Function]"===Object.prototype.toString.call(a)};
Cv=function(a,b,c){var d=Object(a),e=Bv(d[zv]);if(null==a&&!e)throw new TypeError("Array.from requires an array-like object or iterator - not null or undefined");var f;if("undefined"!==typeof b){if(!Bv(b))throw new TypeError("Array.from: when provided, the second argument must be a function");"undefined"!==typeof c&&(f=c)}a=Number(d.length);a=Math.min(Math.max(isNaN(a)?0:0!==a&&isFinite(a)?(0<a?1:-1)*Math.floor(Math.abs(a)):a,0),Math.pow(2,53)-1);c=Bv(this)?Object(new this(a)):Array(a);a:{d=Av(e,
d);for(var g=0;g<a||e;){var k=d(g),l=e?k.value:k;if(e&&k.done){b=c;break a}c[g]=b?"undefined"===typeof f?b(l,g):b.call(f,l,g):l;g+=1}if(e)throw new TypeError("Array.from: provided arrayLike or iterator has length more then 2 ** 52 - 1");c.length=a;b=c}return b};Ev=function(a,b){_.I("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var c=new Dv(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}};
Dv=function(a,b){_.I("PatchedMediaKeysMs.MediaKeySystemAccess");this.keySystem=a;for(var c=!1,d=0;d<b.length;++d){var e=b[d],f={audioCapabilities:[],videoCapabilities:[],persistentState:_.Id,distinctiveIdentifier:_.Id,initDataTypes:e.initDataTypes,sessionTypes:[_.ne],label:e.label},g=!1;if(e.audioCapabilities)for(var k=0;k<e.audioCapabilities.length;++k){var l=e.audioCapabilities[k];l.contentType&&(g=!0,MSMediaKeys.isTypeSupported(this.keySystem,l.contentType.split(";")[0])&&(f.audioCapabilities.push(l),
c=!0))}if(e.videoCapabilities)for(k=0;k<e.videoCapabilities.length;++k)l=e.videoCapabilities[k],l.contentType&&(g=!0,MSMediaKeys.isTypeSupported(this.keySystem,l.contentType.split(";")[0])&&(f.videoCapabilities.push(l),c=!0));g||(c=MSMediaKeys.isTypeSupported(this.keySystem,_.Ge));e.persistentState==_.Yd&&(c=!1);if(c){this.a=f;return}}c=Error(_.lb);c.name=_.Va;c.code=DOMException.NOT_SUPPORTED_ERR;throw c;};
Gv=function(a){_.I("PatchedMediaKeysMs.setMediaKeys");var b=this.mediaKeys;b&&b!=a&&Fv(b,null);delete this.mediaKeys;return(this.mediaKeys=a)?Fv(a,this):Promise.resolve()};Hv=function(a){_.I("PatchedMediaKeysMs.MediaKeys");this.a=new MSMediaKeys(a);this.f=new _.Vg};Fv=function(a,b){function c(){b.msSetMediaKeys(d.a);b.removeEventListener(_.md,c)}_.Yg(a.f);if(!b)return Promise.resolve();a.f.on(b,"msneedkey",Iv);var d=a;try{return 1<=b.readyState?b.msSetMediaKeys(a.a):b.addEventListener(_.md,c),Promise.resolve()}catch(e){return Promise.reject(e)}};
Kv=function(a){_.I("PatchedMediaKeysMs.MediaKeySession");_.Oh.call(this);this.g=null;this.j=a;this.f=this.a=null;this.h=new _.Vg;this.sessionId="";this.expiration=NaN;this.closed=new _.Ti;this.keyStatuses=new Jv};Iv=function(a){_.I("PatchedMediaKeysMs.onMsNeedKey_",a);if(a.initData){var b=document.createEvent("CustomEvent");b.initCustomEvent(_.Vc,!1,!1,null);b.initDataType=_.qc;b.initData=Lv(a.initData);this.dispatchEvent(b)}};
Lv=function(a){if(!a)return a;var b=new _.ek(a);if(1>=b.a.length)return a;for(var c=[],d=0;d<b.a.length;d++)c.push(a.subarray(b.a[d].start,b.a[d].end+1));a=[];b={};d=_.t(c);for(c=d.next();!c.done;b={ld:b.ld},c=d.next())b.ld=c.value,a.some(function(e){return function(f){return _.Vh(f,e.ld)}}(b))||a.push(b.ld);b=0;d=_.t(a);for(c=d.next();!c.done;c=d.next())b+=c.value.length;b=new Uint8Array(+b);d=0;a=_.t(a);for(c=a.next();!c.done;c=a.next())c=c.value,b.set(c,d),d+=c.length;return b};
Mv=function(a,b){var c=a.keyStatuses;c.size=void 0==b?0:1;c.a=b;a.dispatchEvent(new _.M(_.fd))};Jv=function(){this.size=0;this.a=void 0};Ov=function(a){var b=Nv;return b?b+a.charAt(0).toUpperCase()+a.slice(1):a};Qv=function(a,b){_.I("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var c=new Pv(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}};
Sv=function(a){_.I("PatchedMediaKeysWebkit.setMediaKeys");var b=this.mediaKeys;b&&b!=a&&Rv(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&Rv(a,this);return Promise.resolve()};
Pv=function(a,b){_.I("PatchedMediaKeysWebkit.MediaKeySystemAccess");this.a=this.keySystem=a;var c=!1;a==_.Jd&&(this.a=Pu,c=!1);var d=!1;var e=document.getElementsByTagName(_.Ee);e=e.length?e[0]:document.createElement(_.Ee);for(var f=_.t(b),g=f.next();!g.done;g=f.next()){g=g.value;var k={audioCapabilities:[],videoCapabilities:[],persistentState:_.Id,distinctiveIdentifier:_.Id,initDataTypes:g.initDataTypes,sessionTypes:[_.ne],label:g.label},l=!1;if(g.audioCapabilities)for(var m=_.t(g.audioCapabilities),
n=m.next();!n.done;n=m.next())n=n.value,n.contentType&&(l=!0,e.canPlayType(n.contentType.split(";")[0],this.a)&&(k.audioCapabilities.push(n),d=!0));if(g.videoCapabilities)for(m=_.t(g.videoCapabilities),n=m.next();!n.done;n=m.next())n=n.value,n.contentType&&(l=!0,e.canPlayType(n.contentType,this.a)&&(k.videoCapabilities.push(n),d=!0));l||(d=e.canPlayType(_.Ge,this.a)||e.canPlayType("video/webm",this.a));g.persistentState==_.Yd&&(c?(k.persistentState=_.Yd,k.sessionTypes=[_.Md]):d=!1);if(d){this.f=k;
return}}c=_.lb;if(a==_.Jd||a==_.Jc)c="None of the requested configurations were supported.";c=Error(c);c.name=_.Va;c.code=DOMException.NOT_SUPPORTED_ERR;throw c;};Tv=function(a){_.I("PatchedMediaKeysWebkit.MediaKeys");this.j=a;this.f=null;this.a=new _.Vg;this.g=[];this.h=new Map};
Rv=function(a,b){a.f=b;_.Yg(a.a);var c=Nv;b&&(a.a.on(b,c+"needkey",function(d){_.I("PatchedMediaKeysWebkit.onWebkitNeedKey_",d);var e=document.createEvent("CustomEvent");e.initCustomEvent(_.Vc,!1,!1,null);e.initDataType=_.qc;e.initData=_.Qf(d.initData);a.f.dispatchEvent(e)}),a.a.on(b,c+"keymessage",function(d){_.I("PatchedMediaKeysWebkit.onWebkitKeyMessage_",d);var e=Uv(a,d.sessionId);e?(d=new _.M(_.qd,{messageType:void 0==e.keyStatuses.a?"licenserequest":"licenserenewal",message:d.message}),_.I("PatchedMediaKeysWebkit.MediaKeySession.generated"),
e.f&&(e.f.resolve(),e.f=null),e.dispatchEvent(d)):_.Nf("Session not found",d.sessionId)}),a.a.on(b,c+"keyadded",function(d){_.I("PatchedMediaKeysWebkit.onWebkitKeyAdded_",d);if(d=Uv(a,d.sessionId))_.I("PatchedMediaKeysWebkit.MediaKeySession.ready"),Vv(d,_.ye),d.a&&d.a.resolve(),d.a=null}),a.a.on(b,c+"keyerror",function(d){_.I("PatchedMediaKeysWebkit.onWebkitKeyError_",d);var e=Uv(a,d.sessionId);if(e){_.I("PatchedMediaKeysWebkit.MediaKeySession.handleError",d);var f=Error("EME v0.1b key error"),g=
d.errorCode;g.systemCode=d.systemCode;f.errorCode=g;!d.sessionId&&e.f?(45==d.systemCode&&(f.message="Unsupported session type."),e.f.reject(f),e.f=null):d.sessionId&&e.a?(e.a.reject(f),e.a=null):(f=d.systemCode,d.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Vv(e,Ku):1==f?Vv(e,"expired"):Vv(e,_.ed))}}))};Uv=function(a,b){var c=a.h.get(b);return c?(_.I(zu,c),c):(c=a.g.shift())?(c.sessionId=b,a.h.set(b,c),_.I(zu,c),c):null};
Xv=function(a,b,c){_.I("PatchedMediaKeysWebkit.MediaKeySession");_.Oh.call(this);this.h=a;this.m=!1;this.a=this.f=null;this.g=b;this.j=c;this.sessionId="";this.expiration=NaN;this.closed=new _.Ti;this.keyStatuses=new Wv};
Yv=function(a,b,c){if(a.m)return Promise.reject(Error("The session is already initialized."));a.m=!0;try{if(a.j==_.Md)if(c)var d=_.J(_.Xf("LOAD_SESSION|"+c));else{var e=_.Xf("PERSISTENT|"),f=new Uint8Array(e.byteLength+b.byteLength);f.set(e,0);f.set(_.J(b),e.byteLength);d=f}else d=_.J(b)}catch(k){return Promise.reject(k)}a.f=new _.Ti;var g=Ov("generateKeyRequest");try{a.h[g](a.g,d)}catch(k){if("InvalidStateError"!=k.name)return a.f=null,Promise.reject(k);(new _.th(function(){try{a.h[g](a.g,d)}catch(l){a.f.reject(l),
a.f=null}})).X(.01)}return a.f};Zv=function(a,b,c){if(a.a)a.a.then(function(){return Zv(a,b,c)})["catch"](function(){return Zv(a,b,c)});else{a.a=b;if(a.g==Pu){var d=_.Tf(c);var e=JSON.parse(d);"oct"!=e.keys[0].kty&&(a.a.reject(Error("Response is not a valid JSON Web Key Set.")),a.a=null);d=_.Sh(e.keys[0].k);e=_.Sh(e.keys[0].kid)}else d=_.J(c),e=null;var f=Ov("addKey");try{a.h[f](a.g,d,e,a.sessionId)}catch(g){a.a.reject(g),a.a=null}}};
Vv=function(a,b){var c=a.keyStatuses;c.size=void 0==b?0:1;c.a=b;a.dispatchEvent(new _.M(_.fd))};Wv=function(){this.size=0;this.a=void 0};$v=function(){var a=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];c=a.apply(this,c);c.abort=function(){};return c}};aw=function(){var a=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(b,c){return a.call(this,b,c-.001)}};
bw=function(){var a=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(b){return"mp2t"==b.split(/ *; */)[0].split("/")[1].toLowerCase()?!1:a(b)}};cw=function(){var a=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(b){return"opus"!=_.Eg(b)[0]&&a(b)}};
dw=function(){var a=MediaSource.isTypeSupported,b=/^dv(?:h[e1]|a[v1])\./;MediaSource.isTypeSupported=function(c){var d=c.split(/ *; */),e=d.shift(),f={};d=_.t(d);for(var g=d.next();!g.done;g=d.next())g=g.value.split("\x3d"),f[g[0]]=g[1].replace(/"(.*)"/,"$1");d=f.codecs;if(!d)return a(c);var k=!1,l=!1;c=d.split(",").filter(function(n){b.test(n)&&(l=!0);/^(hev|hvc)1\.2/.test(n)&&(k=!0);return!0});l&&(k=!1);f.codecs=c.join(",");k&&(f.eotf="smpte2084");for(var m in f)e+="; "+m+'\x3d"'+f[m]+'"';return cast.__platform__.canDisplayType(e)}};
ew=function(){this.a=new muxjs.mp4.CaptionParser;this.j=[];this.h={}};_.fw=function(){};gw=function(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0,remux:!1});this.f=null;this.m=[];this.j=[];this.g=[];this.h=!1;this.a.on("data",this.w.bind(this));this.a.on("done",this.o.bind(this))};
iw=function(a,b){return!window.muxjs||"mp2t"!=a.toLowerCase().split(";")[0].split("/")[1]&&"aac"!=a.toLowerCase().split(";")[0].split("/")[1]?!1:b?MediaSource.isTypeSupported(hw(b,a))||MediaSource.isTypeSupported(a.replace(/aac/i,_.ud)):MediaSource.isTypeSupported(hw(_.$b,a))||MediaSource.isTypeSupported(a.replace(/aac/i,_.ud))||MediaSource.isTypeSupported(hw(_.Ee,a))};
hw=function(a,b){var c=b.replace(/mp2t/i,_.ud);a==_.$b&&(c=c.replace(_.Ee,_.$b));var d=/avc1\.(66|77|100)\.(\d+)/.exec(c);if(d){var e="avc1.",f=d[1],g=Number(d[2]);e=("66"==f?e+"4200":"77"==f?e+"4d00":e+"6400")+(g>>4).toString(16);e+=(g&15).toString(16);c=c.replace(d[0],e)}return c};jw=function(a,b){a.h=!0;a.f=new _.Ti;a.m=[];a.j=[];a.g=[];var c=_.J(b);a.a.push(c);a.a.flush();a.h&&a.f.reject(new _.K(_.L,3,3018));return a.f};
_.lw=function(a,b,c,d,e){this.j=a;this.A=c;this.g={};this.J=!1;this.f=null;this.h={};this.o=new _.Vg;this.I=!1;this.w={};this.D=b;this.B=d;this.K=e;this.L=this.K.streaming.maxSegmentToMediaOffset||1;this.G=new _.Ti;this.C={};this.m=kw(this,this.G);this.a=new _.G("clpp.mse.MediaSourceEngine")};nw=function(a){var b=_.Dg(a.mimeType,a.codecs),c=av(a);return _.Lg(b)||MediaSource.isTypeSupported(c)||iw(b,a.type)};
kw=function(a,b){var c=new MediaSource,d=ow(c);a.o.one(c,"sourceopen",function(){URL.revokeObjectURL(d);b.resolve()});a.j.src=d;return c};Kw=function(a,b){b.forEach(function(c,d){var e=a.m.addSourceBuffer(c);a.o.on(e,_.Zc,a.Zh.bind(a,d));a.o.on(e,"updateend",a.Lc.bind(a,d));a.g[d]=e;a.h[d]=[];a.C[d]=!1});a.J=b.has(_.$b)&&b.has(_.Ee)};Lw=function(a,b){a.f||(a.f=new _.Hg(a.K,a.A));var c=a.f;if(b!=_.Pb){var d=_.Ig[b];if(!d)throw new _.K(_.L,2,2012,"Text parser is unavailable");c.o=new d(c.B)}};
Mw=function(a){return a.m?a.m.readyState==_.Yc:!0};Ow=function(a){var b={};b.total=new _.Nh(a.j.buffered,"total");b.audio=Nw(a,_.$b);b.video=Nw(a,_.Ee);var c=[];a.f&&(c=[{start:a.f.nb(),end:a.f.qa()}]);b.text=cv(c,_.oe);return b};Nw=function(a,b){try{return new _.Nh(a.g[b].buffered,b)}catch(c){return b in a.g&&a.a.error("failed to get buffered range for "+b,c),null}};
Qw=function(a,b,c,d,e,f,g,k){k=void 0===k?!1:k;var l=a.g[b],m=-1,n=0;l&&l.buffered&&(n=l.buffered.length);b===_.Ee&&null!==d&&null!==e&&k&&(m=0<n?l.buffered.end(n-1):-1);b==_.oe?c=Qu(a.f,c,d,e):a.w[b]?c=jw(a.w[b],c).then(function(p){a.f||Lw(a,_.pe);p.captions&&p.captions.length&&Ru(a.f,p.captions,d,e,a.g.video.timestampOffset);var q=[];0<p.audio.byteLength&&a.g.audio&&q.push(Pw(a,_.$b,a.le.bind(a,_.$b,p.audio.buffer)));0<p.video.byteLength&&a.g.video&&q.push(Pw(a,_.Ee,a.le.bind(a,_.Ee,p.video.buffer)));
return Promise.all(q)}):(f&&window.muxjs&&(a.f||Lw(a,_.pe),null==d&&null==e?a.D.init(c):a.D.g(c,function(p){p.length&&Ru(a.f,p,d,e,a.g.video.timestampOffset)})),c=Pw(a,b,a.le.bind(a,b,c)));return c.then(function(){if(b===_.Ee&&null!==d&&null!==e&&!k)a.B.append(d,e,g);else if(b===_.$b&&null!==d&&null!==e)rv(a.B);else if(b===_.Ee&&null!==d&&null!==e&&k){var p=l.buffered.length,q=0<p?l.buffered.end(p-1):-1;0>m&&0<p&&(m=l.buffered.start(0));0<=m&&0<q&&a.B.append(m,q,g)}if(!a.C[b]&&l&&1===l.buffered.length){p=
l.buffered.start(0);var r=d-p;if(Math.abs(r)>a.L&&0===l.timestampOffset)return a.a.warn("Detected a delta of "+r+" between media times and segment times for "+(b+". The segment start time is ")+(d+" and the media start time is ")+(p+". Adjusting timestampOffset.")),p=Pw(a,b,function(){a.Gg(b,r)}),q=Pw(a,b,a.Qf.bind(a,b,!1)),Promise.all([p,q])}null!==d&&null!==e&&(a.C[b]=!0)})["catch"](function(p){throw p;})};
Sw=function(a,b,c,d,e){if(b==_.oe)return a.f.w=c,a=a.f,a.h=d,a.j=e,Promise.resolve();b=Rw(a,b,c,d,e);a.J&&(b=b.concat(Rw(a,_.$b,c,d,e)));return Promise.all(b)};Rw=function(a,b,c,d,e){return[Pw(a,b,a.Qg.bind(a,b)),Pw(a,b,a.Gg.bind(a,b,c)),Pw(a,b,a.rk.bind(a,b,d,e))]};Pw=function(a,b,c){if(a.I)return Promise.reject();c={start:c,p:new _.Ti};a.h[b].push(c);1===a.h[b].length&&Tw(a,b);return c.p};
Tw=function(a,b){var c=a.h[b][0];if(c)try{a.a.debug("Starting next operation for "+b),c.start()}catch(d){"QuotaExceededError"==d.name?c.p.reject(new _.K(_.L,3,3017,{type:b})):c.p.reject(new _.K(_.L,3,3015,{mediaError:d})),Uw(a,b)}else a.a.debug("No more scheduled operations for "+b)};
Vw=function(a,b){if(a.I)return Promise.reject();var c=[],d;for(d in a.g){var e=new _.Ti,f={start:function(g){g.resolve()}.bind(null,e),p:e};a.h[d].push(f);c.push(e);1==a.h[d].length&&f.start()}return Promise.all(c).then(function(){try{b()}catch(l){var g=Promise.reject(new _.K(_.L,3,3015,{mediaError:l}))}for(var k in a.g)Uw(a,k);return g},function(){return Promise.reject()})};Uw=function(a,b){a.h[b].shift();Tw(a,b)};
Ww=function(a,b,c){function d(f,g,k){return f>=g&&f<=k}var e=a.video;return e&&e.width&&e.height&&!(d(e.width,b.minWidth,Math.min(b.maxWidth,c.width))&&d(e.height,b.minHeight,Math.min(b.maxHeight,c.height))&&d(e.width*e.height,b.minPixels,b.maxPixels))||!d(a.bandwidth,b.minBandwidth,b.maxBandwidth)?!1:!0};Xw=function(a,b,c){var d=!1;a=_.t(a);for(var e=a.next();!e.done;e=a.next()){e=e.value;var f=e.allowedByApplication;e.allowedByApplication=Ww(e,b,c);f!=e.allowedByApplication&&(d=!0)}return d};
$w=function(a,b,c,d){var e=!1;d.variants=d.variants.filter(function(m){if(a&&a.Y&&!Vu(a,m))return _.I("Dropping variant - not compatible with key system",m),!1;var n=m.audio,p=m.video;if(n&&!nw(n)){var q=n.codecs;0<=n.codecs.indexOf("ec-3")?(_.I("Trying to use AC-3 for EC-3"),n.codecs=n.codecs.replace("ec-3","ac-3"),nw(n)?_.Mf("Using AC-3 instead of EC-3 for",Yw(n)):(n.codecs=q,_.Mf(Cu,Yw(n)),m.audio=null,e=!0,n=null)):(_.Mf(Cu,Yw(n)),m.audio=null,e=!0,n=null)}return p&&!nw(p)?(_.Mf("Dropping variant - video not compatible with platform",
Yw(p)),!1):n&&b&&!Zw(n,b)?(_.Mf("Dropping variant - not compatible with active audio","active audio",Yw(b),"variant.audio",Yw(n)),!1):p&&c&&!Zw(p,c)?(_.Mf("Dropping variant - not compatible with active video","active video",Yw(c),"variant.video",Yw(p)),!1):!0});if(e){for(var f=!1,g=!1,k=_.t(d.variants),l=k.next();!l.done;l=k.next())l=l.value,!f&&l.video&&l.audio&&(f=!0),g||l.audio||!l.video||(g=!0);f&&g&&(d.variants=d.variants.filter(function(m){return m.video&&!m.audio?(_.Mf("Dropping variant - not compatible with video + audio",
"variant.video",Yw(m.video)),!1):!0}))}d.textStreams=d.textStreams.filter(function(m){var n=_.Lg(_.Dg(m.mimeType,m.codecs));n||_.I("Dropping text stream. Is not supported by the platform.",m);return n})};Zw=function(a,b){return a.mimeType!=b.mimeType||a.codecs.split(".")[0]!=b.codecs.split(".")[0]?!1:!0};
ax=function(a){return{id:a.id,active:!1,type:_.oe,bandwidth:0,language:a.language,label:a.label,kind:a.kind||null,width:null,height:null,frameRate:null,mimeType:a.mimeType,audioMimeType:null,codecs:a.codecs||null,audioCodec:null,videoCodec:null,primary:a.primary,roles:a.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:a.originalId}};bx=function(a){return a.allowedByApplication&&a.allowedByKeySystem};
cx=function(a,b){var c=a.filter(function(g){return g.audio&&g.audio.channelsCount}),d=new Map;c=_.t(c);for(var e=c.next();!e.done;e=c.next()){e=e.value;var f=e.audio.channelsCount;d.has(f)||d.set(f,[]);d.get(f).push(e)}c=Array.from(d.keys());if(0==c.length)return a;e=c.filter(function(g){return g<=b});return e.length?d.get(Math.max.apply(null,e)):d.get(Math.min.apply(null,c))};
_.ex=function(a,b,c){b=_.uh(b);var d=a,e=a.filter(function(g){return g.primary});e.length&&(d=e);var f=d.length?d[0].language:"";d=d.filter(function(g){return g.language===f});b.some(function(g){var k=_.hv(_.un(g),a.map(function(l){return l.language}));return k?(d=a.filter(function(l){return _.un(l.language)===k}),!0):!1});if(c){b=dx(d,c);if(b.length)return b;_.C("No exact match for the text role could be found.")}else if(b=d.filter(function(g){return 0==g.roles.length}),b.length)return b;b=d.map(function(g){return g.roles}).reduce(_.Nk.me,
[]);return b.length?dx(d,b[0]):d};dx=function(a,b){return a.filter(function(c){return c.roles.includes(b)})};fx=function(a,b,c){for(var d=0;d<c.length;d++)if(c[d].audio==a&&c[d].video==b)return c[d];return null};
Yw=function(a){var b=av(a);return a.type==_.$b?"type\x3daudio mimeType\x3d"+a.mimeType+" codecs\x3d"+a.codecs+" codecInfo\x3d"+b+" bandwidth\x3d"+a.bandwidth+" channelsCount\x3d"+a.channelsCount:a.type==_.Ee?"type\x3dvideo mimeType\x3d"+a.mimeType+" codecs\x3d"+a.codecs+" codecInfo\x3d"+b+" bandwidth\x3d"+a.bandwidth+" frameRate\x3d"+a.frameRate+" width\x3d"+a.width+" height\x3d"+a.height:"unexpected stream type"};
gx=function(a,b){var c=String(_.ph++);c=new _.jh(c,a);c.mimeType=_.lh(b.mimeType);if(a===_.N||a===_.P)c.label=_.lh(b.label),c.language=_.lh(b.language);a===_.mh?(c.frameRate=b.frameRate,c.roles=b.roles):a===_.P?(c.channelsCount=b.channelsCount,c.roles=b.audioRoles||[],c.mimeType=_.lh(b.audioMimeType)):(c.kind=_.lh(b.kind),c.roles=b.roles);return c};
hx=function(a,b,c){var d=new _.kh(a===_.mh?""+b.videoId:a===_.P?""+b.audioId:""+b.id,c);switch(a){case _.mh:d.codec=_.lh(b.videoCodec);d.bandwidth=b.videoBandwidth||b.bandwidth;d.width=b.width;d.height=b.height;d.originalId=b.originalVideoId;break;case _.P:d.codec=_.lh(b.audioCodec);d.bandwidth=b.audioBandwidth||b.bandwidth;d.originalId=b.originalAudioId;break;default:d.codec=_.lh(b.codecs),d.originalId=b.originalTextId}(a=c.renditions.find(function(e){return _.A.Oa(e,d,null,["id","track"])}))||c.renditions.push(d);
return a||d};ix=function(a,b){var c=a.reduce(function(d,e){b===_.mh?null===e.videoId||d[e.videoId]&&!e.active||(d[e.videoId]=e):b===_.P&&(null===e.audioId||d[e.audioId]&&!e.active||(d[e.audioId]=e));return d},{});return Object.values(c)};jx=function(a,b){if(void 0!==b&&null!==b){var c=a.filter(function(d){return d.audio&&d.audio.id===b});if(0<c.length)return c}return a};kx=function(){this.g=new _.G("clpp.mse.TrackManager");this.l=null;this.h=[];this.a=new Map;this.f=new Map};
lx=function(a,b){return a.h.filter(function(c){return c.type===b})};mx=function(a,b){var c=a.a.get(b)||null;return c&&c.track};ox=function(a,b,c){c&&mx(a,c.type)===c||nx(a,b,c&&c.renditions[0])};px=function(a,b){a.a.set(b.track.type,b);b===(a.f.get(b.track.type)||null)&&a.f.set(b.track.type,null)};
nx=function(a,b,c,d){d=void 0===d?!1:d;if(a.l&&(a.a.get(b)||null)!==c){var e=a.l;if(c){if(0>a.h.indexOf(c.track))throw Error("Unknown rendition with ID "+c.id);if(b!==c.track.type)throw Error("Types mismatch");a.g.debug("Activate rendition type\n          "+b+" with ID: "+c.id);if(b===_.N){var f=e.ea().find(function(n){return n.id==c.id});f&&(a.f.set(b,c),px(a,c),e.trigger(new _.M(_.Hh)),qx(e,!0).then(function(){rx(e,f)})["catch"](function(n){a.g.warn("Error while activating track",n)}))}else if(b===
_.P)a.f.set(b,c),sx(e,parseInt(c.id,10));else if(b===_.mh){var g=a.a.get(_.P)||null;if(g){var k=tx(e).filter(function(n){return n.videoId==c.id});var l=k.find(function(n){return n.audioId==g.id});if(!l){a.g.debug("Unable to find exact variant. Searching for equivalent");var m=g.track.renditions.map(function(n){return n.id}).filter(function(n){return n!==g.id});l=k.find(function(n){return m.find(function(p){return p==n.audioId})})}}else l=tx(e).find(function(n){return n.videoId==c.id});l?(a.f.set(b,
c),ux(e,l,d)):a.g.warn("Cannot find matching variant")}}else a.g.debug(_.za+b),mx(a,b)&&(b===_.N?qx(e,!1).then(function(){a.a.set(b,null);e.trigger(new _.M(_.Hh))})["catch"](function(n){a.g.warn("Error while de-activating text tracks",n)}):b===_.P?a.g.info("Enabling ABR for audio is not supported"):ux(e,null,d))}};
yx=function(a){if(a.l){a.g.debug("Track list change detected, updating track list");for(var b=[],c=_.t(Object.values(_.Ho)),d=c.next();!d.done;d=c.next())d=d.value,a.a.set(d,null),a.f.set(d,null);c={};d=_.t(a.l.ea());for(var e=d.next();!e.done;c={Tb:c.Tb},e=d.next()){e=e.value;c.Tb=gx(_.N,e);var f=b.find(function(k){return function(l){return vx(l,k.Tb)}}(c));c.Tb=f||c.Tb;var g=hx(_.N,e,c.Tb);e.active&&a.a.set(_.N,g);f||b.push(c.Tb)}wx(a.l)||a.a.set(_.N,null);c=tx(a.l);xx(a,b,c,_.mh);xx(a,b,c,_.P);
a.h=b}};xx=function(a,b,c,d){var e=ix(c,d);c={};e=_.t(e);for(var f=e.next();!f.done;c={Ub:c.Ub},f=e.next()){f=f.value;c.Ub=gx(d,f);var g=b.find(function(l){return function(m){return vx(m,l.Ub)}}(c));c.Ub=g||c.Ub;var k=hx(d,f,c.Ub);f.active&&a.a.set(d,k);g||b.push(c.Ub)}};vx=function(a,b){return a.type===b.type&&a.channelsCount===b.channelsCount&&a.frameRate===b.frameRate&&a.kind===b.kind&&a.label===b.label&&a.language===b.language&&a.mimeType===b.mimeType&&bv(a.roles,b.roles)};
zx=function(a,b,c){if(b){a.h.length||yx(a);for(var d=b.type,e=a.a.get(d)||null,f,g=_.t(lx(a,d)),k=g.next();!k.done&&!(f=k.value.renditions.find(function(l){return l.id==b.id}));k=g.next());f&&e!==f&&(px(a,f),d===_.P?a.l.trigger(new _.M(_.Gh)):d===_.mh&&a.l.trigger(new _.M(_.Ie,{details:{width:f.width||0,height:f.height||0,bandwidth:f.bandwidth,track:f.track,abrSelection:c}})))}};Ax=function(){this.f=new _.yn(2);this.g=new _.yn(5);this.a=0};Bx=function(a,b){return 128E3>a.a?b:Math.min(_.An(a.f),_.An(a.g))};
_.Cx=function(){this.f=new _.G("clpp.abr");this.w=null;this.j=!1;this.g=new Ax;this.o=[];this.m=1;this.A=!1;this.a=this.h=null};Dx=function(a,b){a&&(b=b.filter(function(c){return Ww(c,a,{width:Infinity,height:Infinity})}));return b.sort(function(c,d){return c.bandwidth-d.bandwidth})};Ex=function(){this.a=new Map};Gx=function(a,b){a.a.has(b)||a.a.set(b,new Fx);return a.a.get(b)};Fx=function(){this.text=this.variant=null};
Hx=function(a,b){this.f=a;this.a=new Set([a]);b=b||[];for(var c=_.t(b),d=c.next();!d.done;d=c.next())this.add(d.value)};Kx=function(a,b){var c;if(!(c=!!a.audio!=!!b.audio||!!a.video!=!!b.video||a.language!=b.language)&&(c=a.audio&&b.audio)){c=a.audio;var d=b.audio;c=!(c.channelsCount==d.channelsCount&&Ix(c,d)&&Jx(c.roles,d.roles))}!c&&(c=a.video&&b.video)&&(c=a.video,d=b.video,c=!(Ix(c,d)&&Jx(c.roles,d.roles)));return c?!1:!0};
Ix=function(a,b){if(a.mimeType!=b.mimeType)return!1;var c=a.codecs.split(",").map(function(f){return _.Eg(f)[0]}),d=b.codecs.split(",").map(function(f){return _.Eg(f)[0]});if(c.length!=d.length)return!1;c.sort();d.sort();for(var e=0;e<c.length;e++)if(c[e]!=d[e])return!1;return!0};Jx=function(a,b){var c=new Set(a),d=new Set(b);c["delete"]("main");d["delete"]("main");if(c.size!=d.size)return!1;c=_.t(c);for(var e=c.next();!e.done;e=c.next())if(!d.has(e.value))return!1;return!0};
Mx=function(a){this.a=a;this.f=new Lx(a.language,"",a.audio&&a.audio.channelsCount?a.audio.channelsCount:0)};Lx=function(a,b,c){this.g=a;this.f=b;this.a=c};Nx=function(a,b){b=_.uh(b);var c=null;b.some(function(d){c=_.hv(_.un(d),a.map(function(e){return gv(e)}));return!!c});return c?a.filter(function(d){return c===gv(d)}):[]};Ox=function(a,b){return a.filter(function(c){var d=c.audio;c=c.video;return d&&0<=d.roles.indexOf(b)||c&&0<=c.roles.indexOf(b)})};
Rx=function(a,b){this.a=Px;this.f=(new Map).set(Px,b).set(Qx,a)};
Tx=function(a){var b=this;this.f=a;this.a=a.getConfiguration().streaming;this.h=new _.Vg;this.g=new _.G("clpp.mse.media.LiveEdgeObserver");Sx(this)&&(a=this.f.getSurface().getMedia(),this.h.on(a,_.re,function(){var c=b.f.getPosition(),d=b.f.getSeekRange().end;c=d-c;var e=b.f.getPlaybackRate(),f=b.a.stopChasingAt;1<=e&&c>=b.a.chaseJumpDistance?(b.g.debug("Too far from edge, jump to beginning."),b.f.setPlaybackRate(1),b.f.seek(d)):1===e&&c>=b.a.startChasingAt?(b.g.debug("Not on live edge, increase playback rate."),
b.f.setPlaybackRate(b.a.chasingRate)):1<e&&c<=f&&(b.g.debug("On live edge, reduce playback rate."),b.f.setPlaybackRate(1))}))};
Sx=function(a){return 1>=a.a.chasingRate?(a.g.warn("chasingRate must be greater than 1."),!1):a.a.chaseJumpDistance<=a.a.startChasingAt?(a.g.warn("chaseJumpDistance must be greater than startChasingAt."),!1):a.a.startChasingAt<=a.a.stopChasingAt?(a.g.warn("startChasingAt must be greater than stopChasingAt."),!1):0>a.a.stopChasingAt?(a.g.warn("stopChasingAt must be greater than or equal to 0."),!1):!0};Ux=function(a){this.g=a;this.a=null;this.f=function(){}};Vx=function(a,b){a.f=b};
Wx=function(a){var b=this;this.a=a;this.h=!1;this.g=this.a.te();this.f=new _.th(function(){b.a.jj(.25*b.g)})};Xx=function(a){a.f.stop();var b=a.h?0:a.g;0<=b?a.a.te()!=b&&a.a.Fg(b):(a.f.Ya(.25),0!=a.a.te()&&a.a.Fg(0))};Zx=function(a,b){this.g=a;this.j=Yx(a);this.a=a.a.currentTime;this.h=Date.now()/1E3;this.m=b;this.f=function(){}};$x=function(a,b){a.f=b};ay=function(a){this.a=a};
Yx=function(a){if(a.a.paused||0==a.a.playbackRate||0===a.a.buffered.length)var b=!1;else a:{b=a.a.buffered;a=a.a.currentTime;for(var c=0;c<b.length;c++){var d=b.start(c),e=b.end(c);if(!(a<d-.1||a>e-.5)){b=!0;break a}}b=!1}return b};cy=function(a,b,c,d,e){var f=this;this.a=a;this.C=b;this.A=c;this.B=e;this.g=new _.Vg;this.w=!1;this.G=a.readyState;this.h=!1;this.f=d;this.j=this.D=this.o=!1;this.g.on(a,_.Le,function(){return by(f)});this.m=(new _.th(function(){by(f)})).Ya(.25)};
by=function(a){if(0!=a.a.readyState){if(a.a.seeking){if(!a.w)return}else a.w=!1;if(!a.a.paused&&!a.j){a.a.readyState!=a.G&&(a.h=!1,a.G=a.a.readyState);var b=a.A.smallGapLimit,c=a.a.currentTime,d=a.a.buffered;a:{var e=new _.Nh(d);if(e.length&&!(1===e.length&&1E-6>e.end(0)-e.start(0)))for(var f=_.si("Edge/")||_.si(_.ib)||_.ti()||_.vi()?.5:.1,g=0;g<e.length;g++)if(e.start(g)>c&&(0===g||e.end(g-1)-c<=f)){e=g;break a}e=null}if(null==e){if(a.f){a=a.f;d=a.g;c=Yx(d);d=d.a.currentTime;b=Date.now()/1E3;if(a.a!=
d||a.j!=c)a.h=b,a.a=d,a.j=c;d=b-a.h;d>=a.m&&c&&a.f(a.a,d)}}else if((0!=e||a.o)&&a.D&&(f=d.start(e),g=Wu(a.C),!(f>=g))){g=f-c;b=g<=b;var k=!1;if(!(.001>g)){if(!b&&!a.h){a.h=!0;var l=new _.M("largegap",{detail:{currentTime:c,gapSize:g}});l.cancelable=!0;a.B(l);a.A.jumpLargeGaps&&!l.defaultPrevented?k=!0:_.Mf("Ignoring large gap at",c,"size",g)}if(b||k)0==e?_.Mf(vu,g,"seconds because of gap before start time of",f):_.Mf(vu,g,"seconds because of gap starting at",d.end(e-1),"and ending at",f),a.a.currentTime=
f}}}}};gy=function(a,b,c,d){this.a=a;this.m=b;this.h=d;this.w=c;this.o=!1;this.f=new _.Vg;this.g=new dy(a);this.j=!1;0<a.readyState?ey(this,c):fy(this,c)};hy=function(a){return a.o?a.a.currentTime:a.w};jy=function(a,b){0<a.a.readyState?iy(a.g,b):fy(a,b)};fy=function(a,b){a.w=b;a.f.off(a.a,_.md);a.f.one(a.a,_.md,function(){ey(a,b)})};ey=function(a,b){a.j||(a.j=!0,a.h&&a.h());.001>Math.abs(a.a.currentTime-b)?ky(a):(a.f.one(a.a,_.ce,function(){ky(a)}),iy(a.g,0==a.a.currentTime?b:a.a.currentTime))};
ky=function(a){a.o=!0;a.f.on(a.a,_.ce,function(){return a.m()})};dy=function(a){var b=this;this.f=a;this.m=10;this.j=this.g=this.h=0;this.a=new _.th(function(){0>=b.h?(_.C(["Failed to move playhead from",b.g,"to",b.j].join(" ")),b.a.stop()):b.f.currentTime!=b.g?b.a.stop():(b.f.currentTime=b.j,b.h--)})};iy=function(a,b){a.g=a.f.currentTime;a.j=b;a.h=a.m;a.f.currentTime=b;a.a.Ya(.1)};
oy=function(a,b,c,d,e,f){var g=this;this.h=a;this.a=b.presentationTimeline;this.B=b.minBufferTime||0;this.m=c;this.A=e;this.w=null;this.j=new cy(a,b.presentationTimeline,c,ly(this,a,c),f);this.g=new gy(a,function(){a:{var k=g.j;k.w=!0;k.o=!1;k.h=!1;k=hy(g.g);var l=my(g,k);if(.001<Math.abs(l-k)){var m=(new Date).getTime()/1E3;if(!g.w||g.w<m-1){g.w=m;jy(g.g,l);k=void 0;break a}}g.f.debug("Seek to "+k);g.A();k=void 0}return k},ny(this,d),function(){g.j.D=!0});this.o=(new _.th(function(){if(0!=g.h.readyState&&
!g.h.paused){var k=hy(g.g),l=Xu(g.a,0),m=Wu(g.a);3>m-l&&(l=m-3);k<l&&(l=my(g,k),g.f.info("Jumping forward "+(l-k)+" seconds to catch up with the seek range."),g.h.currentTime=l)}})).Ya(.25);this.f=new _.G("clpp.mse.Playhead")};qy=function(a){var b=hy(a.g);return 0<a.h.readyState&&!a.h.paused?py(a,b):b};ny=function(a,b){null==b?b=Infinity>a.a.getDuration()?Xu(a.a,0):Wu(a.a):0>b&&(b=Wu(a.a)+b);return ry(a,py(a,b))};ry=function(a,b){var c=a.a.getDuration();return b>=c?c-a.m.durationBackoff:b};
my=function(a,b){var c=new _.Nh(a.h.buffered);c=c.bc.bind(c);var d=Math.max(a.B,a.m.rebufferingGoal),e=a.m.safeSeekOffset,f=Xu(a.a,0),g=Wu(a.a),k=a.a.getDuration();3>g-f&&(f=g-3);var l=Xu(a.a,d),m=Xu(a.a,e);d=Xu(a.a,d+e);if(b>=k)return a.f.debug("Playhead past duration."),ry(a,b);if(b>g)return a.f.debug("Playhead past end."),g;if(b<f){if(c(m))return a.f.debug("Playhead before start \x26 start is buffered"),m;a.f.debug("Playhead before start \x26 start is unbuffered");return d}if(b>=l||c(b))return a.f.debug("Playhead in safe region or in buffered region."),
b;a.f.debug("Playhead outside safe region \x26 in unbuffered region.");return d};py=function(a,b){var c=Xu(a.a,0);if(b<c)return c;c=Wu(a.a);return b>c?c:b};ly=function(a,b,c){if(!c.stallEnabled)return null;var d=c.stallSkip;c=new Zx(new ay(b),c.stallThreshold);$x(c,function(e,f){a.f.warn("Stall detected at "+e+" for "+f+" seconds.");d?(a.f.warn("Seeking forward "+d+" seconds to break stall."),b.currentTime+=d):(a.f.warn("Pausing and unpausing to break stall."),b.pause(),b.play())});return c};
_.sy=function(a,b){this.f=b;this.g=a;this.m=null;this.B=1;this.I=Promise.resolve();this.o=[];this.w=new Map;this.h=new Map;this.K=this.j=this.A=this.C=!1;this.J=0;this.a=new _.G("clpp.mse.Streaming");this.G=!1;this.D=[]};uy=function(a){return _.ty(a,_.$b)};vy=function(a){return _.ty(a,_.Ee)};_.ty=function(a,b){var c=a.h.get(b);return c?c.Nb||c.stream:null};
Ay=function(a,b){var c,d,e,f,g,k,l,m,n,p;return _.y(function(q){switch(q.a){case 1:return c=_.hl,_.v(q,a.f.S.clear(c.TEXT),2);case 2:return a.J++,a.K=!1,d=a.J,e=a.f.S,f=new Map,g=new Set,f.set(c.TEXT,b),g.add(b),_.v(q,e.init(f,!1),3);case 3:return a.j?q["return"]():_.v(q,wy(a,g),4);case 4:if(a.j)return q["return"]();l=(k=e.getTextDisplayer().isTextVisible())||a.m.alwaysStreamText;a.J!=d||a.h.has(c.TEXT)||a.K||!l||(m=a.f.sb(),n=xy(a,m),p=yy(b,n,0),a.h.set(c.TEXT,p),zy(a,p,0));_.x(q)}})};
Cy=function(a,b,c,d){b.video&&_.By(a,b.video,c,d);b.audio&&_.By(a,b.audio,c,d)};
_.By=function(a,b,c,d){var e=a.h.get(b.type);if(!e&&b.type==_.oe&&a.m.ignoreTextStreamFailures)Ay(a,b);else if(e){var f=Dy(a,b);if(c&&f!=e.gc)for(a.a.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),c=_.t(a.h.values()),d=c.next();!d.done;d=c.next())Ey(a,d.value);else{e.Nb&&(a.a.debug("switch during trick play mode",b),b.trickModeVideo?(e.Nb=b,b=b.trickModeVideo,a.a.debug("switch found trick play stream",b)):(e.Nb=null,a.a.debug("switch found no special trick play stream")));
var g=a.o[f];if(g&&g.Nc&&(g=a.w.get(b.id))&&g.Nc)if(e.stream!=b){g=a.g.presentationTimeline.getDuration();var k=a.f.sb();k=Fy(a,e,k);!c&&(e.endOfStream||k>=g)?a.a.debug(Ou+Gy(e)+" already buffered to the end. Not switching."):(b.type==_.oe&&Lw(a.f.S,_.Dg(b.mimeType,b.codecs)),e.stream=b,e.bd=!0,a.a.debug("switch: switching to Stream "+Gy(e)),e.hc?(b=a.f.sb(),g=a.f.S.qa(e.type),f=(f=Hy(a,e,b,g,f))?f.wa?f.wa-f.Ka:null:null,null==f?f=!1:((k=e.stream.initSegmentReference)&&(f+=(k.wa?k.wa-k.Ka:null)||
0),k=a.f.qe().getBandwidthEstimate(),8*f/k<(null===g?0:g-b)-Math.max(a.g.minBufferTime||0,a.m.rebufferingGoal)?f=!0:(b=e.hc,b=b.h?b.h.bytesRemaining:-1,f=0>b||b>f?!0:!1))):f=!1,f&&(a.a.info("Aborting current segment request to switch."),e.hc.abort()),c&&(e.Vb?e.Wd=!0:e.gb?(e.Cb=!0,e.sd=d,e.Wd=!0):(Iy(e),Jy(a,e,!0,d))))}else a.a.debug(Ou+Gy(e)+" already active")}}};
Ky=function(a){function b(k){return a.f.S.bc(k,c,0)}var c=a.f.sb(),d=!1,e=xy(a,c);if(_.Wj(a.h.values(),function(k){return k.gc==e}))for(var f=_.t(a.h.keys()),g=f.next();!g.done;g=f.next())g=g.value,b(g)||(Ey(a,a.h.get(g)),d=!0);else if(!_.Wj(a.h.keys(),b)){a.a.debug("(all): seeked: unbuffered seek: clearing all buffers");d=_.t(a.h.values());for(f=d.next();!f.done;f=d.next())Ey(a,f.value);d=!0}d||a.a.debug("(all): seeked: buffered seek: presentationTime\x3d"+c)};
Ey=function(a,b){var c=Gy(b);b.Vb?a.a.debug(c,"clear: already clearing the buffer"):b.Cb?a.a.debug(c,"clear: already waiting"):b.gb?(a.a.debug(c,"clear: currently updating"),b.Cb=!0,b.sd=0):null==a.f.S.nb(b.type)?(a.a.debug(c,"clear: nothing buffered"),null==b.Ab&&zy(a,b,0)):(a.a.debug(c,"clear: handling right now"),Iy(b),Jy(a,b,!1,0))};
My=function(a,b,c,d,e){var f,g,k,l,m,n,p;return _.y(function(q){if(1==q.a)return f=a.f.sb(),g=xy(a,f),k=_.hl,l=new Map,m=new Set,b&&(l.set(k.AUDIO,b),m.add(b)),c&&(l.set(k.VIDEO,c),m.add(c)),d&&(l.set(k.TEXT,d),m.add(d)),n=a.f.S,p=a.m.forceNativeTS,_.v(q,n.init(l,p),2);if(3!=q.a){if(a.j)return q["return"]();Ly(a);return _.v(q,wy(a,m),3)}if(a.j)return q["return"]();l.forEach(function(r,w){if(!a.h.has(w)){var B=yy(r,g,e);a.h.set(w,B);zy(a,B,0)}});_.x(q)})};
yy=function(a,b,c){return{stream:a,type:a.type,vb:null,ra:null,Nb:null,bd:!0,gc:b,endOfStream:!1,gb:!1,Ab:null,Cb:!1,sd:0,Wd:!1,Vb:!1,Se:!1,Jc:!1,Dg:c||0,hc:null,xd:!1,Yf:0}};
Ny=function(a,b){var c=a.o[b];if(c)return a.a.debug("(all) Period "+b+uu),c.promise;a.a.debug("(all) setting up Period "+b);c={promise:new _.Ti,Nc:!1};a.o[b]=c;for(var d=new Set,e=_.t(a.g.periods[b].variants),f=e.next();!f.done;f=e.next())f=f.value,f.video&&d.add(f.video),f.video&&f.video.trickModeVideo&&d.add(f.video.trickModeVideo),f.audio&&d.add(f.audio);e=_.t(a.g.periods[b].textStreams);for(f=e.next();!f.done;f=e.next())d.add(f.value);a.I=a.I.then(function(){return a.j?null:wy(a,d)}).then(function(){a.j||
(a.o[b].promise.resolve(),a.o[b].Nc=!0,a.a.debug("(all) setup Period "+b))})["catch"](function(g){a.j||(a.o[b].promise["catch"](function(){}),a.o[b].promise.reject(),delete a.o[b],a.a.warn("(all) failed to setup Period "+b),a.f.onError(g))});return c.promise};
wy=function(a,b){var c,d,e,f,g,k,l,m,n,p,q;return _.y(function(r){switch(r.a){case 1:c=[];d=_.t(b);for(e=d.next();!e.done;e=d.next())f=e.value,(g=a.w.get(f.id))?(a.a.debug("(all) Stream "+f.id+uu),c.push(g.promise)):(a.a.debug("(all) setting up Stream "+f.id),a.w.set(f.id,{promise:new _.Ti,Nc:!1}),c.push(f.createSegmentIndex()));_.kf(r,2);return _.v(r,Promise.all(c),4);case 4:if(a.j)return r["return"]();_.lf(r,3);break;case 2:k=_.mf(r);if(a.j)return r["return"]();l=_.t(b);for(e=l.next();!e.done;e=
l.next())m=e.value,a.w.get(m.id).promise["catch"](function(){}),a.w.get(m.id).promise.reject(),a.w["delete"](m.id);throw k;case 3:n=_.t(b);for(e=n.next();!e.done;e=n.next())p=e.value,q=a.w.get(p.id),q.Nc||(q.promise.resolve(),q.Nc=!0,a.a.debug("(all) setup Stream "+p.id));_.x(r)}})};Ly=function(a){var b=a.g.presentationTimeline.getDuration();Infinity>b?a.f.S.Qb(b):a.f.S.Qb(Math.pow(2,32))};
Ry=function(a,b){if(!a.j){var c=Gy(b);if(!b.gb&&null!=b.Ab&&!b.Vb)if(b.Ab=null,b.Cb)a.a.debug(c,"skipping update and clearing the buffer"),Jy(a,b,b.Wd,b.sd);else{try{var d=Oy(a,b);null!=d&&(zy(a,b,d),b.Jc=!1)}catch(e){Py(a,e);return}d=Array.from(a.h.values());Qy(a,b);a.C&&d.every(function(e){return e.endOfStream})&&(a.a.debug(c,"calling endOfStream()..."),a.f.S.endOfStream().then(function(){if(!a.j&&!a.g.presentationTimeline.ec()){var e=a.f.S.getDuration();e<a.g.presentationTimeline.getDuration()&&
a.g.presentationTimeline.Qb(e)}}).then(function(){a.f.hg()}))}}};
Oy=function(a,b){function c(p){return p.type==_.oe&&p.stream.mimeType==_.Pb}if(c(b))return a.f.S.Td(b.stream.originalId||""),null;var d=Gy(b),e=a.f.sb(),f=Fy(a,b,e);a.a.debug(d,"timeNeeded\x3d"+f);var g=Dy(a,b.stream),k=xy(a,f),l=a.f.S.ua(b.type,e);a.a.debug(d,"update_:",Lu+e,"bufferedAhead\x3d"+l);var m=Math.max(a.g.minBufferTime||0,a.m.rebufferingGoal,a.m.bufferingGoal)*a.B,n=a.g.presentationTimeline.ec()?_.ko(a.g.presentationTimeline):a.g.presentationTimeline.getDuration();if(f>=n&&!b.xd)return Sy(a,
b),null;b.endOfStream=!1;b.gc=k;if(k!=g)return a.a.debug(d,"need Period "+k,Lu+e,"timeNeeded\x3d"+f,"currentPeriodIndex\x3d"+g),null;if(l>=m)return a.a.debug(d,"buffering goal met"),a.m.bufferLimitUpdateInterval||.5;k=a.f.S.qa(b.type);k=Hy(a,b,e,k,g);if(!k)return a.g.presentationTimeline.isLive()||b.type===_.oe?a.m.bufferLimitUpdateInterval||1:(a.a.debug("Media state "+d+": no next segment found. Assuming EOS."),Sy(a,b),null);d=Infinity;l=_.t(a.h.values());for(m=l.next();!m.done;m=l.next())m=m.value,
c(m)||(m=Fy(a,m,e),d=Math.min(d,m));if(f>=d+a.g.presentationTimeline.a)return a.m.bufferLimitUpdateInterval||1;b.Dg=0;Ty(a,b,e,g,k);return null};Sy=function(a,b){a.a.debug(Gy(b),"buffered to end of presentation");b.endOfStream=!0;if(b.type==_.Ee){var c=a.h.get(_.oe);c&&c.stream.mimeType==_.Pb&&(c.endOfStream=!0)}};Fy=function(a,b,c){if(!b.vb||!b.ra)return Math.max(c,b.Dg);c=Dy(a,b.vb);return a.g.periods[c].startTime+b.ra.endTime};
Hy=function(a,b,c,d,e){var f=Gy(b);if(b.ra&&b.stream==b.vb)return d=b.ra.position+1,a.a.debug(f,"next position known:","position\x3d"+d),Uy(a,b,e,d);b.ra?(a.a.debug(f,"next position unknown: another Stream buffered"),f=Dy(a,b.vb),f=Vy(a,b,a.g.periods[f].startTime+b.ra.endTime,e)):(a.a.debug(f,"next position unknown: nothing buffered"),f=Vy(a,b,d||c,e));if(null==f)return null;c=null;null==d&&(c=Uy(a,b,e,Math.max(0,f-1)));return c||Uy(a,b,e,f)};
Vy=function(a,b,c,d){var e=Gy(b);d=a.g.periods[d];a.a.debug(e,"looking up segment:","lastSegment.endTime\x3d"+c,Iu+d.startTime);c=Math.max(0,c-d.startTime);b=b.stream.findSegmentPosition(c);null==b&&a.a.warn(e,"cannot find segment:",Iu+d.startTime,"lookupTime\x3d"+c);return b};
Uy=function(a,b,c,d){var e=Gy(b);c=a.g.periods[c];var f=b.stream.getSegmentReference(d);if(!f)return a.a.debug(e,"segment does not exist:",Iu+c.startTime,"position\x3d"+d),null;var g=a.g.presentationTimeline;d=_.lo(g);g=_.ko(g);return!b.xd&&(c.startTime+f.endTime<d||c.startTime+f.startTime>g)?(a.a.debug(e,"segment is not available:",Iu+c.startTime,Nu+f.startTime,Mu+f.endTime,"availabilityStart\x3d"+d,"availabilityEnd\x3d"+g),null):f};
Ty=function(a,b,c,d,e){function f(r,w){if(a.j||a.A)return null;p=!0;return Wy(a,b,c,k,l,e,r,w)}var g=Gy(b),k=a.g.periods[d];a.a.debug(g,"fetchAndAppend_:",Lu+c,Iu+k.startTime,"reference.position\x3d"+e.position,Nu+e.startTime,Mu+e.endTime);var l=b.stream,m=a.g.presentationTimeline.getDuration(),n=a.g.periods[d+1];d=Xy(a,b,d,Math.max(0,k.startTime-.1),n?n.startTime+.01:m,e);b.gb=!0;b.bd=!1;a.a.debug(g,"fetching segment");var p=!1,q=a.f.S.qa(b.type)||0;d.then(function(){return a.j||a.A?null:Yy(a,b,
e,!1,function(r){return f(r.data,!0)})}).then(function(r){return p||a.j||a.A||null===r?(a.j||a.A||Zy(a,b,q,e,l),null):f(r,!1)}).then(function(){a.j||a.A||(Zy(a,b,q,e,l),b.gb=!1,b.Se=!1,b.Cb||a.f.Ld(),zy(a,b,0),$y(a,b,l),a.a.debug(g,"finished fetch and append"))})["catch"](function(r){if(!a.j&&!a.A)if(r,b.gb=!1,b.type==_.oe&&a.m.ignoreTextStreamFailures)1001==r.code?a.a.warn(g,"Text stream failed to download. Proceeding without it."):a.a.warn(g,"Text stream failed to parse. Proceeding without it."),
a.h["delete"](_.oe);else if(7001==r.code)b.gb=!1,b.Ab=null,zy(a,b,0);else if(3017==r.code)az(a,b,r);else if(b.type===_.oe)r instanceof _.K&&r.f(1),Iy(b),a.f.onError(new _.K(1,2,2010,r));else if(1001<=r.code&&1003>=r.code){var w=!0;1001===r.code&&500<=r.data.status||(w=typeof a.f.ge===_.ad&&!a.f.ge(b.stream));w&&(b.Jc=!0,r.f(_.L),Py(a,r))}else a.a.error(g,"failed fetch and append: code\x3d"+r.code),b.Jc=!0,r instanceof _.K&&r.f(_.L),Py(a,r)})};
cz=function(a,b){b=void 0===b?!1:b;if(a.j)a.a.error("Unable to retry after StreamingEngine is destroyed!");else if(a.A)a.a.error("Unable to retry after StreamingEngine encountered a fatal error!");else for(var c=_.t(a.h.values()),d=c.next();!d.done;d=c.next()){d=d.value;var e=Gy(d);if(d.Jc||b&&bz(d))a.a.info(e,"Retrying after failure..."),d.Jc=!1,zy(a,d,.1)}};
az=function(a,b,c){var d=Gy(b);if(Array.from(a.h.values()).some(function(f){return f!=b&&f.Se}))a.a.debug(d,wu,"waiting for another stream to recover...");else{var e=Math.round(100*a.B);if(20<e)a.B-=.2;else if(4<e)a.B-=.04;else{a.a.error(d,"MediaSource threw QuotaExceededError too many times");b.Jc=!0;a.A=!0;a.f.onError(c);return}a.a.warn(d,wu,"reducing buffering goals by "+(100-Math.round(100*a.B))+"%");b.Se=!0}zy(a,b,4)};
Xy=function(a,b,c,d,e,f){c=a.g.periods[c].startTime-f.yb;if(!b.bd&&c===b.Yf)return Promise.resolve();b.Yf=c;var g=Gy(b);a.a.debug(g,"setting timestamp offset to "+c);a.a.debug(g,"setting append window start to "+d);a.a.debug(g,"setting append window end to "+e);d=Sw(a.f.S,b.type,c,d,e);if(!b.stream.initSegmentReference||!b.bd)return d;a.a.debug(g,"fetching init segment");e=Yy(a,b,b.stream.initSegmentReference,!0).then(function(k){if(a.j)return null;a.a.debug(g,"appending init segment");return Qw(a.f.S,
b.type,k,null,null,b.stream.closedCaptions&&0<b.stream.closedCaptions.size)})["catch"](function(k){b.bd=!0;return Promise.reject(k)});return Promise.all([d,e])};
Wy=function(a,b,c,d,e,f,g,k){k=void 0===k?!1:k;var l=Gy(b);if(e.encrypted&&e.keyId&&a.D.length&&!a.D.includes(e.keyId))return a.a.warn(l,"Stream has key restrictions. Blocking."),Iy(b),b.vb=e,b.ra=f,a.f.ge(e,!0),Promise.resolve();var m=e.closedCaptions&&0<e.closedCaptions.size;null!=e.emsgSchemeIdUris&&0<e.emsgSchemeIdUris.length&&(new _.Yj).ba("emsg",a.L.bind(a,d,f,e.emsgSchemeIdUris)).parse(g);return dz(a,b,c).then(function(){if(a.j)return null;a.a.debug(l,"appending media segment");return Qw(a.f.S,
b.type,g,f.startTime+d.startTime,f.endTime+d.startTime,m,e.id,k)}).then(function(){a.j||(a.a.debug(l,"appended media segment"),b.vb=e,b.ra=f)})};
Zy=function(a,b,c,d,e){if(!a.g.presentationTimeline.isLive()&&b.type!==_.oe){var f=Gy(b);c=(a.f.S.qa(b.type)||0)-c;var g=d.endTime-d.startTime,k=c-g;Math.abs(k)>=Math.min(.01,g)&&Math.abs(k)<=Math.min(1,g)&&(a.a.debug(f,"Adjusted segment",d.position,"with real duration",c,"and accounted for",k,"delta between segment duration and real duration"),b.xd=!0,e.adjustSegmentDurations(d.position,k))}};
ez=function(a,b,c){(new _.Yj).O(_.td,_.Zj).O(_.se,_.Zj).O(_.pd,_.Zj).O("minf",_.Zj).O("stbl",_.Zj).ba("stsd",_.ak).O("encv",function(d){d.F.skip(78);_.Zj(d)}).O("sinf",_.Zj).O("schi",_.Zj).O("tenc",function(d){d.F.skip(6);if(_.Ij(d.F)){d.F.skip(1);var e=_.Uh(_.Nj(d.F,16));e!==b.stream.keyId&&(a.a.debug(Gy(b),"Key id from tenc mismatches with key id from manifest. Switching from "+(b.stream.keyId+" to "+e+".")),b.stream.keyId=e)}d.fb.stop()}).parse(c)};
dz=function(a,b,c){if(a.j)return Promise.resolve();var d=Gy(b);a.a.debug(d,"checking buffer length");var e=Math.max(a.m.bufferBehind,a.g.presentationTimeline.a),f=a.f.S.nb(b.type);if(null==f)return a.a.debug(d,"buffer behind okay because nothing buffered:",Lu+c,Eu+e),Promise.resolve();var g=c-f,k=g-e;if(.01>=k)return a.a.debug(d,"buffer behind okay:",Lu+c,Fu+g,Eu+e,"underflow\x3d"+Math.abs(k)),Promise.resolve();a.a.debug(d,"buffer behind too large:",Lu+c,Fu+g,Eu+e,"overflow\x3d"+k);return a.f.S.remove(b.type,
f,f+k).then(function(){a.j||a.a.debug(d,"evicted "+k+" seconds")})};$y=function(a,b,c){if(!a.C){var d=Gy(b);b=Array.from(a.h.values());1!=b.length||b[0].type!=_.oe?a.C=b.every(function(e){return e.type==_.oe||a.G?!0:!e.Cb&&!e.Vb&&e.ra}):a.G&&(a.C=!0);if(a.C){a.a.debug(d,"startup complete");c=Dy(a,c);a.o[c]||Ny(a,c).then(function(){a.j||(a.a.debug(d,Gu),a.f.Ke())})["catch"](_.Nk.cd);for(c=0;c<a.g.periods.length;++c)Ny(a,c)["catch"](_.Nk.cd);a.f.$j&&(a.a.debug(d,"calling onStartupComplete()..."),a.f.$j())}}};
Qy=function(a,b){var c=Gy(b),d=Dy(a,b.stream);if(b.gc!=d){var e=b.gc,f=Array.from(a.h.values());f.every(function(g){return g.gc==e})?f.every(bz)?(a.a.debug(c,"all need Period "+e),Ny(a,e).then(function(){if(!a.j)if(f.every(function(n){var p=bz(n),q=Dy(a,n.stream);return p&&n.gc==e&&q!=e})){var g=a.g.periods[e];a.a.debug(c,"calling onChooseStreams()...");var k=a.f.Le(g);a.G=!k.variant&&!!k.text;var l=new Map;k.variant&&k.variant.video&&l.set(_.Ee,k.variant.video);k.variant&&k.variant.audio&&l.set(_.$b,
k.variant.audio);k.text&&l.set(_.oe,k.text);var m=_.t(a.h.keys());for(k=m.next();!k.done;k=m.next())if(k=k.value,!l.has(k)&&k!=_.oe){a.a.error(c,"invalid Streams chosen: missing "+k+" Stream");a.f.onError(new _.K(_.L,5,5005));return}m=_.t(Array.from(l.keys()));for(k=m.next();!k.done;k=m.next())if(k=k.value,!a.h.has(k))if(k==_.oe)My(a,null,null,l.get(_.oe),g.startTime),l["delete"](k);else{a.a.error(c,"invalid Streams chosen: unusable "+k+" Stream");a.f.onError(new _.K(_.L,5,5005));return}g=_.t(Array.from(a.h.keys()));
for(k=g.next();!k.done;k=g.next())k=k.value,(m=l.get(k))?(_.By(a,m,!1,0),zy(a,a.h.get(k),0)):a.h["delete"](k);a.a.debug(c,Gu);a.f.Ke()}else a.a.debug(c,"ignoring transition to Period",e,"since another is happening")})["catch"](_.Nk.cd)):a.a.debug(c,"all MediaStates need Period "+e+", but not all MediaStates are idle"):a.a.debug(c,"not all MediaStates need Period "+e)}};xy=function(a,b){var c=dv(a.g.periods,b+_.So);return c?a.g.periods.indexOf(c):0};
Dy=function(a,b){for(var c=a.g.periods,d=0;d<c.length;d++){for(var e=c[d],f=new Set,g=_.t(e.variants),k=g.next();!k.done;k=g.next())k=k.value,k.audio&&f.add(k.audio),k.video&&f.add(k.video),k.video&&k.video.trickModeVideo&&f.add(k.video.trickModeVideo);e=_.t(e.textStreams);for(g=e.next();!g.done;g=e.next())f.add(g.value);if(f.has(b))return d}return-1};
Yy=function(a,b,c,d,e){d=void 0===d?!1:d;e=void 0===e?null:e;var f=_.vn(c.Ra(),c.Ka,c.wa,a.m.attemptParameters,c.startTime,c.endTime,b.type,c.timescale);f.type=_.Jo;f.onFragment=c.Ec?null:e;if(e=c.a())f.keyInfo=e,f.onFragment=null;d&&(f.responseModifiers.push(function(g){ez(a,b,g.data)}),b.type===_.Ee&&a.m.overridePasp&&f.responseModifiers.push(a.P.bind(a)));a.a.debug("fetching: reference\x3d",c);c=a.f.wb.fetch(f);b.hc=c;return c.promise.then(function(g){var k=a.f.qe(),l=g.timeMs,m=g.data.byteLength;
l&&m&&!d&&k.segmentDownloaded(l,m);b.hc=null;return g.data})};Jy=function(a,b,c,d){var e,f,g,k;return _.y(function(l){if(1==l.a)return e=Gy(b),b.Cb=!1,b.Wd=!1,b.sd=0,b.Vb=!0,a.a.debug(e,"clearing buffer"),d?(g=a.f.sb(),k=a.f.S.getDuration(),f=a.f.S.remove(b.type,g+d,k)):f=a.f.S.clear(b.type).then(function(){return!a.j&&c?a.f.S.flush(b.type):null}),_.v(l,f,2);if(a.j)return l["return"]();a.a.debug(e,"cleared buffer");b.vb=null;b.ra=null;b.Vb=!1;b.endOfStream=!1;b.xd=!1;zy(a,b,0);_.x(l)})};
zy=function(a,b,c){a.a.debug(Gy(b),"updating in "+c+" seconds");b.Ab=(new _.rh(function(){Ry(a,b)})).X(c)};Iy=function(a){null!=a.Ab&&(a.Ab.stop(),a.Ab=null)};fz=function(a){var b,c,d,e;return _.y(function(f){b=[];c=_.t(a.h.values());for(d=c.next();!d.done;d=c.next())e=d.value,Iy(e),e.gb&&e.hc&&(e.gb=!1,b.push(e.hc.abort())),e.Cb&&b.push(Jy(a,e,!0,0));return _.v(f,Promise.all(b),0)})};
gz=function(a,b,c){(a=a.h.get(b))&&c&&(Iy(a),a.stream=c,a.vb=c,a.ra&&(a.ra=c.getSegmentReference(a.ra.position)),a.ra||(a.vb=null))};Py=function(a,b){var c;_.y(function(d){switch(d.a){case 1:if(a.j)return d["return"]();if(!a.f.Hg){d.H(2);break}_.kf(d,3);return _.v(d,a.f.Hg(b),5);case 5:_.lf(d,2);break;case 3:c=_.mf(d),c.g=b,b=c;case 2:if(!b.j)a.f.onError(b);_.x(d)}})};Gy=function(a){return"("+a.type+":"+a.stream.id+")"};bz=function(a){return!a.gb&&null==a.Ab&&!a.Cb&&!a.Vb};
jz=function(a){_.tj.call(this,Hu);var b=this;this.C=hz;this.h=null;this.Ee=0;this.bg=2;this.Rc=null;this.Ce=!1;this.m=new _.Vg;this.Ea=this.Bd=this.yc=this.zc=this.o=this.G=this.j=null;this.Qc=!1;this.g=this.f=this.B=this.a=this.vc=this.K=null;this.Bg=1E9;this.Ed=new Set;this.P=!0;this.aa=null;this.vg=!1;this.cg=0;this.Y=null;this.R=new Ex;this.Ag={width:Infinity,height:Infinity};this.D=null;this.Z=_.Sn;this.wc=new Lx(this.configuration.preferredAudioLanguage,this.configuration.preferredAudioRole,
this.configuration.preferredAudioChannelCount);this.ja=this.configuration.preferredTextLanguage;this.L=this.xc=null;this.rc=new Map;this.da=null;this.Ma=this.configuration.preferredTextRole;a&&a(this);this.De=null;this.m.on(window,"online",function(){b.C==iz&&cz(b.a)})};
kz=function(a){return new _.pv(function(b){if(void 0===b||null===b)return null;var c=a.getTrackManager(),d=[];if(c){c=_.t(c.getVideoTracks());for(var e=c.next();!e.done;e=c.next())d.push.apply(d,_.df(e.value.renditions))}return d.find(function(f){return f.id==b})||null})};
lz=function(a,b){if(a.Z!==b)if(a.Z===_.kl&&b!==_.Sn){var c=$u(b,_.Zn);a.log.info(_.Au+c)}else{c=a.Ee;c=0===c?0:Date.now()-c;var d=a.Z;a.Z=b;a.Ee=Date.now();a.D&&_.Wk(a.D.a,a.Z);b===_.cm&&(a.bg=a.xe?1:2);var e=a.bg,f={currentState:a.Z,previousState:d,timeSinceLastStateChangeMS:c,reason:b===_.cm||d===_.cm?e:void 0},g=$u(d,_.Zn),k=$u(b,_.Zn),l=b!==_.cm?"":"["+$u(e,_.Yn)+"]";a.log.info(_.Xa+g+" -\x3e "+(k+l));a.trigger(new _.M(_.he,{detail:f}));(b===_.Xn||b===_.kl)&&a.Ea&&a.Ea.stop();b===_.cm?a.trigger(new _.M(_.jc,
{detail:{bufferedTimeMS:-1,reason:e}})):d===_.cm&&a.trigger(new _.M(_.ic,{detail:{bufferedTimeMS:c,reason:e}}))}};rz=function(a){var b=!1;b=void 0===b?!0:b;var c;return _.y(function(d){switch(d.a){case 1:return a.C==mz?d["return"](Promise.reject(new _.K(_.L,7,7E3))):_.v(d,nz(a),2);case 2:return _.v(d,oz(a),3);case 3:if(!b){d.H(0);break}c=a.getSurface().getMedia();return _.v(d,pz(a,c),5);case 5:return _.v(d,qz(a,c),0)}})};
pz=function(a,b){a.h||(a.m.on(b,_.Zc,function(){if(a.h.error){var c=a.h.error.code;if(1==c)c=null;else{var d=a.h.error.msExtendedCode;d&&(0>d&&(d+=Math.pow(2,32)),d=d.toString(16));c=new _.K(_.L,3,3016,{code:c,extendedError:d,message:a.h.error.message})}}else c=null;if(c)a.onError(c)}),a.h=b);return Promise.resolve()};oz=function(a){a.h&&(a.m.off(a.h,_.Zc),a.h=null);return Promise.resolve()};
nz=function(a){var b;return _.y(function(c){switch(c.a){case 1:a.C!=mz&&(a.C=hz);if(b=a.h)a.m.off(b,_.ld),a.m.off(b,_.Pd),a.m.off(b,_.Ld),a.m.off(b,_.Yc),a.m.off(b,_.Ud),a.m.off(b,_.Sd);a.zc&&(a.zc.release(),a.zc=null);a.Ea&&(a.Ea.stop(),a.Ea=null);if(!a.B){c.H(2);break}return _.v(c,a.B.stop(),3);case 3:a.B=null;case 2:if(!a.g){c.H(4);break}return _.v(c,a.g.stop(),4);case 4:if(!a.a){c.H(6);break}return _.v(c,a.a.destroy(),7);case 7:a.a=null;case 6:a.o&&(a.o.release(),a.o=null);if(!a.G){c.H(8);break}return _.v(c,
a.G.destroy(),9);case 9:a.G=null;case 8:a.Bd&&(a.Bd.release(),a.Bd=null);b&&b.src&&(b.removeAttribute("src"),b.load());if(!a.j){c.H(10);break}return _.v(c,a.j.destroy(),11);case 11:a.j=null;case 10:a.R.clear(),a.K=null,a.Ed.clear(),a.f=null,a.D=null,a.P=!0,a.rc.clear(),a.Qc=!1,sz(a),_.x(c)}})};
qz=function(a,b){var c,d,e;return _.y(function(f){if(1==f.a)return c=window.muxjs?new ew:new _.fw,d=_.pg(a.configuration,["html",_.ee]),a.I=d.create(a),a.Rc=kz(a),a.Rc.track(a),e=new _.lw(b,c,a.I,a.Rc,a.configuration),_.v(f,e.G,2);a.G=e;_.x(f)})};tz=function(a,b){var c,d;return _.y(function(e){if(1==e.a)return c=a.getNetworkEngine(),d=a,_.v(e,_.To.create(b.url,c,a.configuration.manifest.attemptParameters,b.type),2);d.B=e.f;a.B.configure(a.configuration.manifest);_.x(e)})};
xz=function(a,b){var c;return _.y(function(d){a.vc=new iv;jv(a.vc,function(e){uz(a,_.fh,e)});c=new _.ml(Promise.resolve().then(function(){var e,f,g;return _.y(function(k){switch(k.a){case 1:if(a.f){k.H(3);break}_.kf(k,4);e=a;return _.v(k,a.B.start(b.url,vz(a)),6);case 6:e.f=k.f;_.lf(k,1);break;case 4:f=_.mf(k);if(!a.Fa)throw f;return _.v(k,a.Fa(b.url,f),8);case 8:if(g=k.f)b.url=g;else throw f;k.H(1);break;case 3:!a.f.presentationTimeline||_.A.N(a.configuration.suggestedPresentationDelay)||isNaN(a.configuration.suggestedPresentationDelay)||
(a.log.info("Apply suggested presentation delay of: "+a.configuration.suggestedPresentationDelay),a.f.presentationTimeline.D=a.configuration.suggestedPresentationDelay);a.f.presentationTimeline&&(a.f.presentationTimeline.C=!!a.configuration.lowLatencyMode);if(0==a.f.periods.length)throw new _.K(_.L,4,4014);wz(a.f.periods);_.x(k)}})}),function(){a.log.info("Aborting parser step...");return a.B.stop()});return _.v(d,c.promise,0)})};
Fz=function(a){var b,c,d,e,f;return _.y(function(g){switch(g.a){case 1:a.j=new _.ik({wb:a.getNetworkEngine(),onError:function(k){return a.onError(k)},Me:function(k){if(a.a){var l=yz(a),m=!1,n=Object.keys(k);0==n.length&&a.log.warn("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var p=1==n.length&&"00"==n[0];p&&a.log.warn("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");
if(n.length){n=_.t(l.variants);for(var q=n.next();!q.done;q=n.next()){q=q.value;var r=[];q.audio&&r.push(q.audio);q.video&&r.push(q.video);r=_.t(r);for(var w=r.next();!w.done;w=r.next()){var B=w.value;w=q.allowedByKeySystem;B.keyId&&(B=k[p?"00":B.keyId],q.allowedByKeySystem=!!B&&!zz.includes(B));w!=q.allowedByKeySystem&&(m=!0)}}}n=[];if(!p)for(var E in k)zz.includes(k[E])||n.push(E);a.log.debug("allowedKeyIds",n);a.a.D=n;k=uy(a.a);p=vy(a.a);(k=fx(k,p,l.variants))&&!k.allowedByKeySystem&&(a.log.debug("Choosing new streams after key status changed"),
Az(a,l));m&&(Bz(a),Cz(a,l.variants))}},onExpirationUpdated:function(k,l){if(a.B&&a.B.onExpirationUpdated)a.B.onExpirationUpdated(k,l);a.trigger(new _.M(_.Oc,{expirationTime:l}))},onEvent:function(k){return a.ke(k)},getConfiguration:function(){return a.getConfiguration()},Ic:function(){return a.Ic()}});Dz(a);c=(b=a.configuration.drm)?b.offlineId||"":"";d=[];e=_.$m(a.f.periods);if(!c){g.H(2);break}f=_.vj(_.yc);if(!f){g.H(2);break}return _.v(g,f.dk(b,e,a.getNetworkEngine()),4);case 4:return _.v(g,f.Vi(c),
5);case 5:d=g.f;case 2:return _.v(g,_.nk(a.j,e,d),6);case 6:Ez(a,a.f.periods),_.x(g)}})};
Rz=function(a){var b,c,d,e,f,g,k,l,m,n,p;return _.y(function(q){if(1==q.a)return b=a.h,c=function(r){a.h&&a.K&&(r.type===_.ce&&a.Hd?(a.K.a=Qx,sz(a)):r.type===_.Le&&a.getState()===_.Dn&&.1>a.getBufferInfo().ua(a.getPosition())?(a.K.a=Qx,sz(a)):Gz(a));Hz(a)},d=function(){if(a.h){var r=a.h.playbackRate;0!=r&&a.yc.set(r)}},a.m.on(b,_.Pd,c),a.m.on(b,_.Ld,c),a.m.on(b,_.Yc,c),a.m.on(b,_.ce,c),a.m.on(b,_.be,c),a.m.on(b,_.Sd,c),a.m.on(b,_.Le,c),a.m.on(b,_.Ud,d),a.g||(a.g=new _.Cx,a.g.configure(a.configuration.abr)),
Iz(a,a.f.periods),a.wc=new Lx(a.configuration.preferredAudioLanguage,a.configuration.preferredAudioRole,a.configuration.preferredAudioChannelCount),a.ja=a.configuration.preferredTextLanguage,a.Ma=a.configuration.preferredTextRole,_.v(q,_.yk(a.j,b),2);if(3!=q.a){if(!a.j)throw new _.K(_.L,7,7001);a.g.init(function(r,w,B){!a.P&&Jz(a,r,w,B)});a.o=Kz(a,a.configuration.startTime);a.zc=Lz(a);a.yc=new Wx({te:function(){return b.playbackRate},Fg:function(r){b.playbackRate=r},jj:function(r){b.currentTime+=
r}});a.isLive()&&a.configuration.streaming.enableLiveEdgeChasing&&(a.Bd=new Tx(a));e=Math.max(1E-4,a.configuration.streaming.rebufferingGoal);Mz(a,e);a.a=Nz(a);a.a.m=a.configuration.streaming;Oz(a);a.C=iz;return _.v(q,a.a.start(),3)}if(!a.a)throw new _.K(_.L,7,7001);a.configuration.streaming.startAtSegmentBoundary&&(f=qy(a.o),g=Pz(a,f),jy(a.o.g,g));k=_.t(a.f.periods);for(l=k.next();!l.done;l=k.next())m=l.value,Qz(a,m);Bz(a);n=yz(a)||a.f.periods[0];p=n.variants.some(function(r){return r.primary});
a.configuration.preferredAudioLanguage||p||a.log.warn("No preferred audio language set.  We will choose an arbitrary language initially");Cz(a,n.variants);a.m.one(b,_.ld,function(){a.D.o=Date.now()/1E3-(null===a.De?0:a.De)});_.x(q)})};
wz=function(a){function b(d){return d.video&&d.audio||d.video&&d.video.codecs.includes(",")}if(a.some(function(d){return d.variants.some(b)})){_.I("Found variant with audio and video content, so filtering out audio-only content in all periods.");a=_.t(a);for(var c=a.next();!c.done;c=a.next())c=c.value,c.variants=c.variants.filter(b)}};
Oz=function(a){function b(r){var w="";r.video&&(w=_.Eg(r.video.codecs)[0]);var B="";r.audio&&(B=_.Eg(r.audio.codecs)[0]);return w+"-"+B}var c=a.f.periods.flatMap(function(r){return r.variants});c=cx(c,a.configuration.preferredAudioChannelCount);if(1<a.f.periods.length){for(var d=function(r){r=r.split(".");var w=r[0];1<r.length&&(w+="."+r[1]);return w.toLowerCase()},e=[],f=_.t(a.f.periods),g=f.next();!g.done;g=f.next()){var k=new Set;g=_.t(g.value.variants);for(var l=g.next();!l.done;l=g.next())l=
l.value,null!==l.audio&&k.add(d(l.audio.codecs));e.push(k)}var m=e[0];f={};for(k=1;k<e.length;f={Yd:f.Yd},k++)f.Yd=e[k],m=new Set(_.df(m).concat().filter(function(r){return function(w){return r.Yd.has(w)}}(f)));c=c.filter(function(r){return 0===m.size&&null==r.audio?!0:0<m.size&&null==r.audio?!1:m.has(d(r.audio.codecs))})}e=new _.Sg;c=_.t(c);for(f=c.next();!f.done;f=c.next())f=f.value,k=b(f),e.push(k,f);var n=null,p=Infinity;Su(e,function(r,w){for(var B=0,E=0,F=_.t(w),D=F.next();!D.done;D=F.next())B+=
D.value.bandwidth||0,++E;B/=E;a.log.debug(_.Ec,r,"avg bandwidth",B);B<p&&(n=r,p=B)});var q=a.configuration.preferredVideoCodec;q&&Su(e,function(r,w){_.$f(r,q)&&(a.log.info("Selected codec based on preference: "+r),n=r,p=w.reduce(function(B,E){return B+E.bandwidth||0},0)/w.length)});c=_.t(a.f.periods);for(e=c.next();!e.done;e=c.next())e=e.value,e.variants=e.variants.filter(function(r){if(b(r)==n)return!0;a.log.debug("Dropping Variant (better codec available)",r);return!1})};
Kz=function(a,b){return new oy(a.h,a.f,a.configuration.streaming,b,function(){a.zc&&mv(a.zc,!0);a.a&&Ky(a.a)},function(c){return a.dispatchEvent(c)})};Lz=function(a){var b=new Ux(a.f);Vx(b,function(){Bz(a)});var c=new kv(a.vc);lv(c,function(e){e.kg&&e.kg();uz(a,_.hh,e)},function(e){e.Ij&&e.Ij();uz(a,_.ih,e)},function(e,f){f||(uz(a,_.hh,e),uz(a,_.ih,e))});var d=new nv(a.h);d.a.add(b);d.a.add(c);return d};Mz=function(a,b){a.K=new Rx(b,Math.min(.5,b/2));a.K.a=Qx;sz(a);a.Ea=(new _.th(function(){Gz(a)})).Ya(.25)};
Gz=function(a){switch(a.C){case iz:a:if(a.h.ended||Mw(a.G))var b=!0;else{if(a.f.presentationTimeline.isLive()){b=_.ko(a.f.presentationTimeline);var c=a.getBufferInfo();if(null!==c&&(c=c.qa(),null!==c&&c>=b)){b=!0;break a}}b=!1}break;default:b=!1}var d=0;if(a.G){var e=Ow(a.G);c=e.video;e=e.audio;var f=a.h.currentTime;if(c||e)d=c&&e?Math.min(c.ua(f),e.ua(f)):c?c.ua(f):e.ua(f)}c=a.K;e=d;f=b;var g=c.f.get(c.a);d=c.a;e=f||e>=g?Px:Qx;c.a=e;c=d!=e;d=Sz(a);a.log.debug("Buffering state change",c,"is buffering",
d,"buffered to end",b,"state",a.getState());c||a.getState()===_.cm&&!d?sz(a):a.Qc&&Hz(a)};Nz=function(a){var b={sb:function(){return qy(a.o)},S:a.G,wb:a.getNetworkEngine(),Le:a.Xh.bind(a),Ke:a.Wh.bind(a),onError:a.onError.bind(a),hg:a.Gj.bind(a),onEvent:a.ke.bind(a),pg:a.Yh.bind(a),Ld:a.Uj.bind(a),qe:function(){return a.g},ge:a.fh.bind(a),Hg:a.wk.bind(a)};return new _.sy(a.f,b)};Dz=function(a){var b=_.il(a.configuration.drm);a.j.h=b};
tx=function(a){if(a.f&&a.o){var b=Tz(a),c=[];a=_.t(Uz(a));for(var d=a.next();!d.done;d=a.next()){d=d.value;var e=d.audio,f=d.video,g=e?e.codecs:null,k=f?f.codecs:null,l=[];k&&l.push(k);g&&l.push(g);var m=f&&f.mimeType||null,n=e&&e.mimeType||null,p=[];e&&p.push(e.kind);f&&p.push(f.kind);p=p[0]||null;var q=new Set,r=new Set;if(e)for(var w=_.t(e.roles),B=w.next();!B.done;B=w.next())r.add(B.value);if(f)for(w=_.t(f.roles),B=w.next();!B.done;B=w.next())q.add(B.value);g={id:d.id,active:!1,type:"variant",
bandwidth:d.bandwidth,language:d.language,label:null,kind:p,width:null,height:null,frameRate:null,mimeType:m,audioMimeType:n,codecs:l.join(", "),audioCodec:g,videoCodec:k,primary:d.primary,roles:Array.from(q),audioRoles:Array.from(r),videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null};f&&(g.videoId=f.id,g.originalVideoId=f.originalId,g.width=f.width||null,g.height=f.height||null,g.frameRate=f.frameRate||
null,g.videoBandwidth=f.bandwidth||null);e&&(g.audioId=e.id,g.originalAudioId=e.originalId,g.channelsCount=e.channelsCount,g.audioBandwidth=e.bandwidth||null,g.label=e.label,g.audioRoles=e.roles);e=g;e.active=d==b;c.push(e)}return c}return[]};rx=function(a,b){if(a.f&&a.a){var c=yz(a),d=c.textStreams.find(function(e){return e.id==b.id});d?(Vz(a,c,d,!1),Wz(a,d),a.ja=d.language):a.log.error(_.xu,b.id)}};
ux=function(a,b,c){var d=void 0===d?0:d;if(a.f&&a.a){var e=yz(a);if(a.configuration.abr.enabled&&b)a.log.info("Disable ABR and enable manual track selection to select "+(b.width+"x"+b.height+"@"+b.bandwidth)),a.configuration.abr.enabled=!1,a.g.disable();else if(!a.configuration.abr.enabled&&!b){a.log.info("Enable ABR Selection");a.configuration.abr.enabled=!0;a.g.enable();a.L=null;c=Cz(a,e.variants);null!=a.da&&(a.wc=a.da,a.da=null);null==c||a.P||Jz(a,c);return}if(b){a.L=b.id;var f=e.variants.find(function(g){return g.id==
b.id});f?(a.L=f.video.id,bx(f)?(Xz(a,e,f,!1),Yz(a,f,c,d),null==a.da&&(a.da=a.wc),a.wc=new Mx(f),Cz(a,e.variants)):a.log.error("Unable to switch to restricted track",b.id)):a.log.error("No variant with id",b.id)}else a.L=null,null!=a.da&&(a.wc=a.da,a.da=null),c=Cz(a,e.variants),null==c||a.P||Jz(a,c)}};
sx=function(a,b){if(a.a&&(a.f||a.o)){var c=vy(a.a),d=uy(a.a),e=dv(a.f.periods,qy(a.o)),f=a.f.periods[e?a.f.periods.indexOf(e):0].variants.filter(function(m){return m.audio.id==b&&bx(m)});e=f.find(function(m){return m.video.id==c.id});var g=!1;if(!e){a.log.debug("Cannot find exact variant, looking for anything else that matches with given audioId");g=!0;var k=a.getTrackManager().Aa();if(k){var l=k.renditions.map(function(m){return m.id});e=f.find(function(m){return l.find(function(n){return n==m.video.id})})}}if(e){if(d.codecs.split(".")[0]===
e.audio.codecs.split(".")[0]){d=e.audio;a.xc=d.id;a.g.setVariants(f);f=yz(a);Xz(a,f,e,!1);g||a.P?Yz(a,e,!0,0):_.By(a.a,d,!0,0);Promise.resolve();return}a.log.warn("Target audio codecs not compatible with active audio codecs.")}}Promise.reject()};wx=function(a){var b=a.Ce;return a.f?a.G.getTextDisplayer().isTextVisible():b};
qx=function(a,b){var c,d,e,f;return _.y(function(g){c=a.Ce;d=b;if(c==d)return g["return"]();a.Ce=d;if(a.C!=iz)return g.H(0);a.G.getTextDisplayer().setTextVisibility(b);if(a.configuration.streaming.alwaysStreamText)return g.H(0);if(!b){var k=a.a;k.K=!0;var l=k.h.get(_.oe);l&&(Iy(l),k.h["delete"](_.oe));return g.H(0)}e=yz(a);f=_.ex(e.textStreams,a.ja,a.Ma);return 0<f.length?_.v(g,Ay(a.a,f[0]),0):g.H(0)})};
Xz=function(a,b,c,d){var e=a.getTrackManager();if(e){var f=a.D.w;if(c.video){zx(e,c.video,d);var g=e.fa();f.h!==g&&(f.h=g,f.a.push({timestamp:Date.now()/1E3,id:g.id,trackId:g.track.id,type:g.track.type,fromAdaptation:d,width:g.width,height:g.height,bandwidth:g.bandwidth}))}c.audio&&(zx(e,c.audio,d),e=e.xa(),f.f!==e&&(f.f=e,f.a.push({timestamp:Date.now()/1E3,id:e.id,trackId:e.track.id,type:e.track.type,fromAdaptation:d,width:null,height:null,bandwidth:e.bandwidth})))}Gx(a.R,b).variant=c};
Vz=function(a,b,c,d){Gx(a.R,b).text=c;if(b=a.getTrackManager())zx(b,c,d),c=b.za(),a=a.D.w,a.g!==c&&(a.g=c,a.a.push({timestamp:Date.now()/1E3,id:c.id,trackId:c.track.id,type:c.track.type,fromAdaptation:d,width:null,height:null,bandwidth:null}))};
Iz=function(a,b){for(var c=0;c<b.length;c++){for(var d=b[c],e=new Map,f=_.t(d.variants),g=f.next();!g.done;g=f.next())if(g=g.value,g.video&&g.video.closedCaptions){g=g.video;for(var k=_.t(g.closedCaptions.keys()),l=k.next();!l.done;l=k.next())if(l=l.value,!e.has(l)){var m={id:a.Bg++,originalId:l,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,yb:0,mimeType:_.Pb,codecs:"",kind:"caption",
encrypted:!1,keyId:null,language:g.closedCaptions.get(l),label:null,type:_.oe,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:g.roles,channelsCount:null,closedCaptions:null};e.set(l,m)}}e=_.t(e.values());for(f=e.next();!f.done;f=e.next())d.textStreams.push(f.value)}};
Ez=function(a,b){for(var c=a.a?uy(a.a):null,d=a.a?vy(a.a):null,e=_.t(b),f=e.next();!f.done;f=e.next())$w(a.j,c,d,f.value);c=ev(b,function(g){return g.variants.some(bx)});if(0==c)throw new _.K(_.L,4,4032);if(c<b.length)throw new _.K(_.L,4,4011);c=_.t(b);for(d=c.next();!d.done;d=c.next())d=d.value,Xw(d.variants,a.configuration.restrictions,a.Ag)&&a.a&&yz(a)==d&&Bz(a),Zz(a,d.variants)};
Qz=function(a,b){var c=a.a?uy(a.a):null,d=a.a?vy(a.a):null;$w(a.j,c,d,b);d=b.variants;if(!d.some(bx))throw new _.K(_.L,4,4011);Zz(a,b.variants);Xw(d,a.configuration.restrictions,a.Ag)&&a.a&&yz(a)==b&&Bz(a);if(!_.ti(2)&&(c=a.j?a.j.getDrmInfo():null)){d=_.t(d);for(var e=d.next();!e.done;e=d.next()){e=_.t(e.value.drmInfos);for(var f=e.next();!f.done;f=e.next())if(f=f.value,f.keySystem==c.keySystem){f=_.t(f.initData||[]);for(var g=f.next();!g.done;g=f.next())g=g.value,_.xk(a.j,g.initDataType,g.initData)}}}};
Yz=function(a,b,c,d){c=void 0===c?!1:c;d=void 0===d?0:d;a.P?(a.aa=b,a.vg=c,a.cg=d):Cy(a.a,b,c,d)};Wz=function(a,b){a.P?a.Y=b:_.By(a.a,b,!0,0)};Pz=function(a,b){function c(g,k){if(!g)return null;var l=g.findSegmentPosition(k-f.startTime);return null==l?null:(l=g.getSegmentReference(l))?l.startTime+f.startTime:null}var d=uy(a.a),e=vy(a.a),f=yz(a);d=c(d,b);e=c(e,b);return null!=e&&null!=d?Math.max(e,d):null!=e?e:null!=d?d:b};Sz=function(a){return a.j&&a.j.C?!0:a.K?a.K.getState()===Qx:!1};
sz=function(a){if(a.D&&a.K&&a.o){var b=$z(a)===_.cm,c=a.yc;c.h=b;Xx(c);a.o.j.j=b;Hz(a)}};Hz=function(a){lz(a,$z(a))};$z=function(a){var b=a.getDuration(),c=a.getPosition();return a.h&&a.h.ended||(a.Qc||a.Z===_.Xn)&&1>=Math.abs(b-c)?_.Xn:Sz(a)||a.Hd?_.cm:a.h&&a.h.paused?_.bo:_.Dn};
Cz=function(a,b){try{Zz(a,b)}catch(e){return a.onError(e),null}var c=b.filter(function(e){return bx(e)});c=jx(c,a.xc);var d=a.wc.create(c);d=Array.from(d.values());a.g.setVariants(d);if(null!==a.L&&null!==a.xc&&(d=d.find(function(e){return e.video.id==a.L&&e.audio.id==a.xc}),a.L=null,d))return d;if(a.configuration.abr.enabled||null===a.L)return a.g.chooseVariant();c=c.find(function(e){return null!==e.video&&e.video.id===a.L});return c?c:(a.log.warn("Selected video track not found. Falling back to ABR selection"),
a.g.chooseVariant())};Az=function(a,b){var c=Cz(a,b.variants);a.xc=c&&c.audio&&c.audio.id;c&&(Xz(a,b,c,!0),Yz(a,c,!0));(c=_.ex(b.textStreams,a.ja,a.Ma)[0]||null)&&(a.configuration.streaming.alwaysStreamText||wx(a))&&(Vz(a,b,c,!0),Wz(a,c))};
cA=function(a,b){a.P=!0;a.g.disable();a.log.debug("Choosing new streams after period changed");var c=Cz(a,b.variants),d=_.ex(b.textStreams,a.ja,a.Ma)[0]||null;a.aa&&(b.variants.includes(a.aa)&&(c=a.aa),a.aa=null);a.Y&&(b.textStreams.includes(a.Y)&&(d=a.Y),a.Y=null);c&&aA(a,b,function(){return Xz(a,b,c,!0)});d&&(a.configuration.streaming.alwaysStreamText||wx(a))&&aA(a,b,function(){return Vz(a,b,d,!0)});b===yz(a)&&bA(a);return a.configuration.streaming.alwaysStreamText||wx(a)?{variant:c,text:d}:{variant:c,
text:null}};Jz=function(a,b,c,d){c=void 0===c?!1:c;d=void 0===d?0:d;if(a.configuration.abr.enabled){a.log.debug("switch_");var e=dA(a,b);aA(a,e,function(){return Xz(a,e,b,!0)});e===yz(a)&&bA(a);a.a&&Cy(a.a,b,c,d)}};Bz=function(a){var b=a.getTrackManager();b&&a.C!=mz&&(b.l&&(yx(b),b.l.trigger(new _.M(_.Io))),bA(a))};bA=function(a){var b=yz(a);if(b){var c=a.rc.get(b)||[];for(a.rc["delete"](b);c.length;)c.shift()()}};aA=function(a,b,c){a.rc.has(b)||a.rc.set(b,[]);a.rc.get(b).push(c)};
uz=function(a,b,c){a.trigger(new _.M(b,{detail:{schemeIdUri:c.schemeIdUri,value:c.value,startTime:c.startTime,endTime:c.endTime,id:c.id,eventElement:c.eventElement,type:c.type}}))};
Zz=function(a,b){var c=a.j?_.A.hf(a.j.da):{},d=Object.keys(c);d=d.length&&"00"==d[0];for(var e=!1,f=!1,g=[],k=[],l=_.t(b),m=l.next();!m.done;m=l.next()){m=m.value;var n=[];m.audio&&n.push(m.audio);m.video&&n.push(m.video);n=_.t(n);for(var p=n.next();!p.done;p=n.next())if(p=p.value,p.keyId){var q=c[d?"00":p.keyId];q?zz.includes(q)&&(k.includes(q)||k.push(q)):g.includes(p.keyId)||g.push(p.keyId)}m.allowedByApplication?m.allowedByKeySystem&&(e=!0):f=!0}if(!e)throw new _.K(_.L,4,4012,{hasAppRestrictions:f,
missingKeys:g,restrictedKeyStatuses:k});};Uz=function(a){a=yz(a);return null==a?[]:a.variants.filter(function(b){return bx(b)})};eA=function(a){var b=yz(a);return null==b?[]:b.textStreams.filter(function(c){return!a.Ed.has(c)})};yz=function(a){var b=qy(a.o),c=null;a=_.t(a.f.periods);for(var d=a.next();!d.done;d=a.next())d=d.value,d.startTime<=b&&(c=d);return c};Tz=function(a){var b=yz(a);return b&&Gx(a.R,b).variant};
dA=function(a,b){for(var c=_.t(a.f.periods),d=c.next();!d.done;d=c.next())if(d=d.value,d.variants.includes(b))return d;return null};
fA=function(a,b,c){var d,e,f,g,k,l,m,n,p,q,r,w,B,E,F,D,H,O,R;return _.y(function(T){switch(T.a){case 1:return d=_.hl,_.kf(T,2),_.v(T,_.To.create(b.url,a.getNetworkEngine(),a.configuration.manifest.attemptParameters,b.type),4);case 4:return e=T.f,e.configure(a.configuration.manifest),_.v(T,e.start(b.url,vz(a)),5);case 5:f=T.f;wz(f.periods);if(!f.periods.length)throw new _.K(_.L,4,4014);return _.v(T,a.B.stop(),6);case 6:a.B=e;g=c.audio&&c.audio.id;k=c.video&&c.video.id;a.f.periods=f.periods;l=dv(f.periods,
qy(a.o))||f.periods[0];Oz(a);m=yv(g,k,l.variants);n=_.ex(l.textStreams,a.ja,a.Ma)[0]||null;Cz(a,l.variants);p=m&&m.video;q=m&&m.audio;r=[];w=new Set;B=_.t(l.variants);for(E=B.next();!E.done;E=B.next())F=E.value,F.video&&w.add(F.video),F.audio&&w.add(F.audio);D=_.t(_.df(w).concat(_.df(l.textStreams)));for(H=D.next();!H.done;H=D.next())O=H.value,r.push(O.createSegmentIndex());return _.v(T,Promise.all(r),7);case 7:gz(a.a,d.AUDIO,q);gz(a.a,d.VIDEO,p);gz(a.a,d.TEXT,n);m&&Xz(a,l,m,!1);a.log.info("Switch CDN successful.");
_.lf(T,0);break;case 2:R=_.mf(T);if(!e){T.H(8);break}return _.v(T,e.stop(),8);case 8:throw R;}})};
vz=function(a){return{networkingEngine:a.getNetworkEngine(),filterNewPeriod:function(b){return Qz(a,b)},filterAllPeriods:function(b){return Ez(a,b)},onTimelineCueAdded:function(b){var c=a.vc;a:{var d=_.t(c.a);for(var e=d.next();!e.done;e=d.next())if(e=e.value,e.schemeIdUri===b.schemeIdUri&&e.startTime===b.startTime&&e.endTime===b.endTime){d=e;break a}d=null}null==d&&(c.a.add(b),c.f(b))},onEvent:function(b){return a.ke(b)},onError:function(b){return a.onError(b)}}};gA=function(){this.name=Hu};
Yu=function hA(a){var c;return _.sf(hA,function(d){1==d.a&&(c=0);if(3!=d.a)return c<a?_.v(d,c,3):d.H(0);c++;return d.H(2)})};iv.prototype.release=function(){this.f=function(){};this.a.clear()};iv.prototype.cues=function(){return this.a};kv.prototype.release=function(){this.j=null;this.h.clear();this.a=function(){};this.f=function(){};this.g=function(){}};
kv.prototype.m=function(a,b){for(var c={},d=_.t(this.j.cues()),e=d.next();!e.done;c={ae:c.ae,kd:c.kd},e=d.next()){e=e.value;c.ae=this.h.get(e)||null;c.kd=a<e.startTime?1:a>e.endTime?3:2;this.h.set(e,c.kd);var f=this.o.find(function(g){return function(k){return k.qc===g.ae&&k.pc===g.kd}}(c));f&&f.$b(e,b)}};nv.prototype.release=function(){this.g.stop();for(var a=_.t(this.a),b=a.next();!b.done;b=a.next())b.value.release();this.a.clear()};
_.pv.prototype.track=function(a){null!=this.a&&(this.a&&(this.a.off(_.$d,this.g),this.h&&this.a.off(_.re,this.g)),this.a=null);a&&(this.a=a,this.a.on(_.$d,this.g,this))};
_.pv.prototype.append=function(a,b,c){var d=this.m?this.m(c):null;d||this.log.debug("Unable to resolve rendition for id",c);c={start:a,end:b,rendition:d,width:d?d.width:0,height:d?d.height:0,bandwidth:d?d.bandwidth:0};var e=this.f.find(function(f){return f.start>=a&&f.end<=b});if(e)e.rendition=d,e.width=c.width,e.height=c.height,e.bandwidth=c.bandwidth,e.start=c.start,e.end=c.end;else{d=_.t(this.f);for(e=d.next();!e.done;e=d.next())e=e.value,a>=e.start&&a<e.end?e.end=a:b>=e.start&&b<e.end&&(e.start=
b);this.f.push(c);this.f.sort(ov)}sv(this);this.g();this.a&&this.a.trigger(new _.M(_.He))};_.pv.prototype.clear=function(){this.f=[];sv(this);this.a&&(this.a.trigger(new _.M(_.He)),this.a.trigger(new _.M(_.ec)))};
_.pv.prototype.g=function(){if(this.a){var a=this.a.getPosition();if(0<=a){a:{for(var b=this.f.length,c=Number.MAX_SAFE_INTEGER,d=0;d<b;d++){var e=this.f[d];c=Math.min(e.start,c);if(e.start<=a&&e.end>a){a=.1>e.end-a&&d<b-1?this.f[d+1].rendition:e.rendition;break a}if(e.start>a)break}a=0<b&&c>a&&.25>c-a?this.f[0].rendition:null}if(a&&this.j!==a&&(this.j=a,this.a)){c=b=-1;if(a)b=a.width||-1,c=a.height||-1;else if(d=this.a.getSurface().getMedia())b=d.videoWidth,c=d.videoHeight;this.a.trigger(new _.M(_.gc,
{detail:{width:b,height:c,bandwidth:a?a.bandwidth:null,rendition:a}}))}}}};_.u(vv,_.kg);_.h=vv.prototype;
_.h.append=function(a){function b(e){if(e.startTime>=e.endTime)_.C("Invalid cue times: "+e.startTime+" - "+e.endTime),e=null;else{var f=e.payload||"";f=f.replace(/<br\s*\/?>/igm,"\n");f=_.eg(f);f=new VTTCue(e.startTime,e.endTime,f);f.line=-1;try{f.align=_.rc}catch(g){f.align="middle"}e.writingMode===_.Ce?f.vertical="lr":e.writingMode===_.De&&(f.vertical="rl");e=f}e&&c.push(e)}var c=[],d=_.t(a);for(a=d.next();!a.done;a=d.next())b(a.value);a=c.slice().sort(function(e,f){return e.startTime!==f.startTime?
e.startTime-f.startTime:e.endTime!==f.endTime?e.endTime-f.startTime:c.indexOf(f)-c.indexOf(e)});d=_.t(a);for(a=d.next();!a.done;a=d.next())this.a.addCue(a.value)};_.h.remove=function(a,b){if(!this.a)return!1;wv(this.a,function(c){return c.startTime<b&&c.endTime>a});return!0};_.h.isTextVisible=function(){return this.a.mode==_.de};_.h.setTextVisibility=function(a){null!==this.a&&(this.a.mode=a?_.de:_.cd)};_.h.destroy=function(){this.a&&wv(this.a,function(){return!0});this.a=null;return Promise.resolve()};xv.prototype.U=function(){return!0};xv.prototype.create=function(a){return new vv(a)};xv.prototype.create=xv.prototype.create;xv.prototype.isSupported=xv.prototype.U;_.og(_.ee,new xv);var zv=Du;_.Bl(function(){if(_.ti(3)){_.I("Array.install");try{_.Xe(),_.cf(),_.Xe(),_.cf(),zv=Symbol.iterator?Symbol.iterator:Du}catch(a){zv=Du}Array.from=Cv}});Dv.prototype.createMediaKeys=function(){_.I("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var a=new Hv(this.keySystem);return Promise.resolve(a)};Dv.prototype.getConfiguration=function(){_.I("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration");return this.a};Hv.prototype.createSession=function(a){_.I("PatchedMediaKeysMs.MediaKeys.createSession");a=a||_.ne;if(a!=_.ne)throw new TypeError(_.eb+a+_.ba);return new Kv(this.a,a)};
Hv.prototype.setServerCertificate=function(){_.I("PatchedMediaKeysMs.MediaKeys.setServerCertificate");return Promise.resolve(!1)};_.wf(Kv,_.Oh);_.h=Kv.prototype;_.h.generateRequest=function(a,b){_.I("PatchedMediaKeysMs.MediaKeySession.generateRequest");this.a=new _.Ti;try{this.g=this.j.createSession(_.Ge,_.J(b),null),this.h.on(this.g,"mskeymessage",this.Qj.bind(this)),this.h.on(this.g,"mskeyadded",this.Oj.bind(this)),this.h.on(this.g,"mskeyerror",this.Pj.bind(this)),Mv(this,_.ie)}catch(c){this.a.reject(c)}return this.a};
_.h.load=function(){_.I("PatchedMediaKeysMs.MediaKeySession.load");return Promise.reject(Error(_.Na))};_.h.update=function(a){_.I("PatchedMediaKeysMs.MediaKeySession.update");this.f=new _.Ti;try{this.g.update(_.J(a))}catch(b){this.f.reject(b)}return this.f};_.h.close=function(){_.I("PatchedMediaKeysMs.MediaKeySession.close");try{this.g.close(),this.closed.resolve(),_.Yg(this.h)}catch(a){this.closed.reject(a)}return this.closed};
_.h.remove=function(){_.I("PatchedMediaKeysMs.MediaKeySession.remove");return Promise.reject(Error(_.Oa))};_.h.Qj=function(a){_.I("PatchedMediaKeysMs.onMsKeyMessage_",a);this.a&&(this.a.resolve(),this.a=null);this.dispatchEvent(new _.M(_.qd,{messageType:void 0==this.keyStatuses.a?_.id:_.hd,message:a.message.buffer}))};
_.h.Oj=function(a){_.I("PatchedMediaKeysMs.onMsKeyAdded_",a);this.a?(_.I("Simulating completion for a PR persistent license."),Mv(this,_.ye),this.a.resolve(),this.a=null):this.f&&(Mv(this,_.ye),this.f.resolve(),this.f=null)};
_.h.Pj=function(a){_.I("PatchedMediaKeysMs.onMsKeyError_",a);a=Error("EME PatchedMediaKeysMs key error");a.errorCode=this.g.error;if(null!=this.a)this.a.reject(a),this.a=null;else if(null!=this.f)this.f.reject(a),this.f=null;else switch(this.g.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Mv(this,_.Kd);break;default:Mv(this,_.ed)}};var iA;_.h=Jv.prototype;_.h.forEach=function(a){this.a&&a(this.a,iA)};_.h.get=function(a){if(this.has(a))return this.a};
_.h.has=function(a){var b=iA;return this.a&&_.Vh(_.J(a),_.J(b))?!0:!1};_.h.entries=function(){};_.h.keys=function(){};_.h.values=function(){};
_.Bl(function(){!window.HTMLVideoElement||!window.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(_.Mf("Using ms-prefixed EME v20140218"),iA=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Gv,window.MediaKeys=Hv,window.MediaKeySystemAccess=Dv,navigator.requestMediaKeySystemAccess=Ev)});Pv.prototype.createMediaKeys=function(){_.I("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var a=new Tv(this.a);return Promise.resolve(a)};Pv.prototype.getConfiguration=function(){_.I("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration");return this.f};
Tv.prototype.createSession=function(a){_.I("PatchedMediaKeysWebkit.MediaKeys.createSession");a=a||_.ne;if(a!=_.ne&&a!=_.Md)throw new TypeError(_.eb+a+_.ba);var b=this.f||document.createElement(_.Ee);b.src||(b.src="about:blank");a=new Xv(b,this.j,a);this.g.push(a);return a};Tv.prototype.setServerCertificate=function(){_.I("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate");return Promise.resolve(!1)};_.u(Xv,_.Oh);_.h=Xv.prototype;
_.h.generateRequest=function(a,b){_.I("PatchedMediaKeysWebkit.MediaKeySession.generateRequest");return Yv(this,b,null)};_.h.load=function(a){_.I("PatchedMediaKeysWebkit.MediaKeySession.load");return this.j==_.Md?Yv(this,null,a):Promise.reject(Error(yu))};_.h.update=function(a){_.I("PatchedMediaKeysWebkit.MediaKeySession.update",a);var b=new _.Ti;Zv(this,b,a);return b};
_.h.close=function(){_.I("PatchedMediaKeysWebkit.MediaKeySession.close");if(this.j!=_.Md){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var a=Ov("cancelKeyRequest");try{this.h[a](this.g,this.sessionId)}catch(b){}}this.closed.resolve();return this.closed};_.h.remove=function(){_.I("PatchedMediaKeysWebkit.MediaKeySession.remove");return this.j!=_.Md?Promise.reject(Error(yu)):this.close()};_.h=Wv.prototype;_.h.forEach=function(a){this.a&&a(this.a,_.Ro.value())};
_.h.get=function(a){if(this.has(a))return this.a};_.h.has=function(a){var b=_.Ro.value();return this.a&&Zu(a,b)?!0:!1};_.h.entries=function(){};_.h.keys=function(){};_.h.values=function(){};var Nv="";
_.Bl(function(){if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)_.Mf("Using webkit-prefixed EME v0.1b"),Nv="webkit";else if(HTMLMediaElement.prototype.generateKeyRequest)_.Mf("Using nonprefixed EME v0.1b");else return;navigator.requestMediaKeySystemAccess=Qv;delete HTMLMediaElement.prototype.mediaKeys;HTMLMediaElement.prototype.mediaKeys=null;HTMLMediaElement.prototype.setMediaKeys=
Sv;window.MediaKeys=Tv;window.MediaKeySystemAccess=Pv}});_.Bl(function(){_.I("MediaSource.install");if(window.MediaSource)if(window.cast&&cast.__platform__&&cast.__platform__.canDisplayType)_.Mf("Patching Chromecast MSE bugs."),dw();else if(_.wi()){var a=navigator.appVersion;a=0<=a.indexOf("Version")?parseInt(a.match(/Version\/(\d+)/)[1],10):13;bw();10>=a?(_.Mf("Blacklisting MSE on Safari \x3c\x3d 10."),window.MediaSource=null):12>=a?(_.Mf("Patching Safari 11 \x26 12 MSE bugs."),$v(),aw()):(_.Mf("Patching Safari 13 MSE bugs."),$v())}else _.ti(2)||_.ti(3)||
_.ti(4)?cw():_.Mf("Using native MSE as-is.");else _.Mf("No MSE implementation available.")});ew.prototype.init=function(a){var b=muxjs.mp4.probe;a=_.J(a);this.j=b.videoTrackIds(a);this.h=b.timescale(a);this.a.init()};ew.prototype.g=function(a,b){var c=_.J(a);(c=this.a.parse(c,this.j,this.h))&&c.captions&&b(c.captions);this.a.clearParsedCaptions()};ew.prototype.f=function(){this.a.resetCaptionStream()};_.fw.prototype.init=function(){};_.fw.prototype.g=function(){};_.fw.prototype.f=function(){};gw.prototype.destroy=function(){this.a&&(this.a.dispose(),this.a=null);return Promise.resolve()};gw.prototype.w=function(a){this.g=a.captions;var b=new Uint8Array(a.data.byteLength+a.initSegment.byteLength);b.set(a.initSegment,0);b.set(a.data,a.initSegment.byteLength);a.type===_.Ee?this.m.push(b):a.type===_.$b&&this.j.push(b)};gw.prototype.o=function(){var a={video:_.Wh.apply(null,this.m),captions:this.g,audio:_.Wh.apply(null,this.j)};this.f.resolve(a);this.h=!1};_.h=_.lw.prototype;
_.h.destroy=function(){var a=this;this.I=!0;var b=[],c;for(c in this.h){var d=this.h[c],e=d[0];this.h[c]=d.slice(0,1);e&&b.push(e.p["catch"](_.Nk.cd));for(e=1;e<d.length;++e)d[e].p["catch"](_.Nk.cd),d[e].p.reject()}this.f&&b.push(this.f.destroy());this.A&&b.push(this.A.destroy());for(var f in this.w)b.push(this.w[f].destroy());return Promise.all(b).then(function(){a.o&&(a.o.release(),a.o=null);a.j&&(a.j.removeAttribute("src"),a.j.load(),a.j=null);a.m=null;a.f=null;a.A=null;a.g={};a.w={};a.C={};a.D=
null;a.J=!1;a.h={}})};
_.h.init=function(a,b){var c=this,d;return _.y(function(e){if(1==e.a)return d=_.hl,_.v(e,c.G,2);a.forEach(function(f,g){var k=_.Dg(f.mimeType,f.codecs);if(g==d.TEXT)Lw(c,k);else{var l=new Map;l.set(g,k);if((!MediaSource.isTypeSupported(k)||!b||f.keyInfo)&&iw(k,g)){c.w[g]=new gw;k="aac"==k.toLowerCase().split(";")[0].split("/")[1]?k.replace(/aac/i,_.ud):hw(g,k);var m=new Map;m.set(g,k);try{var n=k.match(/"(.*?)"/)[0].replace(/"/g,"").split(","),p=new Map;if(1<n.length)for(var q=_.t(n),r=q.next();!r.done;r=
q.next()){var w=r.value;w.startsWith("avc")?p.set(_.Ee,'video/mp4;codecs\x3d"'+w+'"'):w.startsWith("mp4a")&&p.set(_.$b,'audio/mp4;codecs\x3d"'+w+'"')}l=0<p.size?p:m}catch(B){l=m}}Kw(c,l)}});_.x(e)})};_.h.nb=function(a){return a===_.oe?this.f.nb():(a=Nw(this,a))?a.nb():null};_.h.qa=function(a){return a===_.oe?this.f.qa():(a=Nw(this,a))?a.qa():null};_.h.bc=function(a,b,c){return a===_.oe?this.f.bc(b):(a=Nw(this,a))?a.bc(b,!1,c):!1};
_.h.ua=function(a,b){if(a===_.oe)return this.f.ua(b);var c=Nw(this,a);return c?c.ua(b):0};_.h.Td=function(a){var b=this.qa(_.Ee)||0;this.f.Td(a,b)};_.h.remove=function(a,b,c){var d=this;return a===_.oe?this.f.remove(b,c):Pw(this,a,this.Cg.bind(this,a,b,c)).then(function(){if(a===_.Ee){var e=d.nb(a),f=d.qa(a);null!==e&&null!==f&&uv(d.B,e,f)}else a===_.$b&&(e=d.B,e.a&&e.a.trigger(new _.M(_.ec)))})};
_.h.clear=function(a){if(a==_.oe){if(!this.f)return Promise.resolve();this.D.f();return this.f.remove(0,Infinity)}return Pw(this,a,this.Cg.bind(this,a,0,this.m.duration))};_.h.flush=function(a){return a==_.oe?Promise.resolve():Pw(this,a,this.Qf.bind(this,a))};_.h.endOfStream=function(a){var b=this;return Vw(this,function(){Mw(b)||(a?b.m.endOfStream(a):b.m.endOfStream())})};_.h.Qb=function(a){var b=this;Vw(this,function(){b.m.duration=a})};_.h.getDuration=function(){return this.m.duration};
_.h.le=function(a,b){this.a.debug("Appending data to "+a+tu);try{this.g[a].appendBuffer(b)}catch(c){throw this.a.warn("Failed to append data for "+a,c),c;}this.a.debug("Done Appending data to "+a+tu)};_.h.Cg=function(a,b,c){if(c<=b)this.Lc(a);else{this.a.debug("Removing data from "+a+" range:",b,c);try{this.g[a].remove(b,c)}catch(d){throw this.a.warn("Failed to remove data from "+a+" buffer. Range:",b,c,d),d;}this.a.debug("Done Removing data from "+a+" range:",b,c)}};
_.h.Qg=function(a){try{this.a.debug("Aborting operations for "+a+tu);var b=this.g[a].appendWindowStart,c=this.g[a].appendWindowEnd;this.g[a].abort();this.g[a].appendWindowStart=b;this.g[a].appendWindowEnd=c}catch(d){throw this.a.warn("Failed to abort operations for "+a+tu,d),d;}this.a.debug("Done Aborting operations for "+a+tu);this.Lc(a)};
_.h.Qf=function(a){try{this.j.readyState>HTMLMediaElement.HAVE_NOTHING?(this.a.debug("Flushing buffer for "+a),this.j.currentTime-=.001):this.a.warn("Skip buffer flush for "+a+" with element state: "+this.j.readyState)}catch(b){throw this.a.warn("Failed to flush buffer for "+a,b),b;}this.a.debug("Done Flushing buffer for "+a);this.Lc(a)};
_.h.Gg=function(a,b){0>b&&(b+=.001);try{this.a.debug("Setting timestamp offset for "+a,b),this.g[a].timestampOffset=b}catch(c){throw this.a.warn("Failed to set timestamp offset for "+a,b,c),c;}this.a.debug("Done Setting timestamp offset for "+a,b);this.Lc(a)};
_.h.rk=function(a,b,c){try{this.a.debug("Setting append window for "+a,b,c),this.g[a].appendWindowStart=0,this.g[a].appendWindowEnd=c,this.g[a].appendWindowStart=b}catch(d){throw this.a.warn("Failed to set append window for "+a,b,c,d),d;}this.a.debug("Done Setting append window for "+a,b,c);this.Lc(a)};_.h.Zh=function(a){this.h[a][0].p.reject(new _.K(_.L,3,3014,{mediaError:this.j.error?this.j.error.code:0}))};
_.h.Lc=function(a){var b=this.h[a][0];b&&(b.p.resolve(),this.a.debug("Update-End received for "+a),Uw(this,a))};_.h.getTextDisplayer=function(){return this.A};var ow=window.URL.createObjectURL;_.u(kx,_.Q);_.h=kx.prototype;_.h.Gb=function(a){this.l=a};_.h.release=function(){this.h=[];this.a.clear();this.f.clear()};_.h.load=function(){};_.h.destroy=function(){this.release();this.l=null};_.h.getVideoTracks=function(){return lx(this,_.mh)};_.h.getAudioTracks=function(){return lx(this,_.P)};_.h.ea=function(){return lx(this,_.N)};_.h.fa=function(){return this.a.get(_.mh)||null};_.h.xa=function(){return this.a.get(_.P)||null};_.h.za=function(){return this.a.get(_.N)||null};
_.h.Pa=function(){return this.f.get(_.mh)||null};_.h.Za=function(){return this.f.get(_.P)||null};_.h.$a=function(){return this.f.get(_.N)||null};_.h.Aa=function(){return mx(this,_.mh)};_.h.ha=function(){return mx(this,_.P)};_.h.ia=function(){return mx(this,_.N)};_.h.Wa=function(a){ox(this,_.mh,a)};_.h.la=function(a){ox(this,_.P,a)};_.h.ta=function(a){ox(this,_.N,a)};_.h.Va=function(a,b){nx(this,_.mh,a,void 0===b?!1:b)};_.h.ib=function(a,b){nx(this,_.P,a,void 0===b?!1:b)};
_.h.kb=function(a,b){nx(this,_.N,a,void 0===b?!1:b)};_.h.addTextTrack=function(a){var b=this;return _.y(function(c){return b.l?_.v(c,b.l.addTextTrack(a.url,a.language,a.kind,a.mimeType,a.codec,a.label),0):c.H(0)})};_.h.oa=function(){return!!this.l&&this.l.oa()};kx.prototype.isAbrEnabled=kx.prototype.oa;kx.prototype.addTextTrack=kx.prototype.addTextTrack;kx.prototype.setTextRendition=kx.prototype.kb;kx.prototype.setAudioRendition=kx.prototype.ib;kx.prototype.setVideoRendition=kx.prototype.Va;
kx.prototype.setTextTrack=kx.prototype.ta;kx.prototype.setAudioTrack=kx.prototype.la;kx.prototype.setVideoTrack=kx.prototype.Wa;kx.prototype.getTextTrack=kx.prototype.ia;kx.prototype.getAudioTrack=kx.prototype.ha;kx.prototype.getVideoTrack=kx.prototype.Aa;kx.prototype.getLoadingTextRendition=kx.prototype.$a;kx.prototype.getLoadingAudioRendition=kx.prototype.Za;kx.prototype.getLoadingVideoRendition=kx.prototype.Pa;kx.prototype.getTextRendition=kx.prototype.za;kx.prototype.getAudioRendition=kx.prototype.xa;
kx.prototype.getVideoRendition=kx.prototype.fa;kx.prototype.getTextTracks=kx.prototype.ea;kx.prototype.getAudioTracks=kx.prototype.getAudioTracks;kx.prototype.getVideoTracks=kx.prototype.getVideoTracks;_.h=_.Cx.prototype;_.h.stop=function(){this.w=null;this.j=!1;this.o=[];this.m=1;this.h=null};_.h.init=function(a){this.w=a};
_.h.chooseVariant=function(){var a=Dx(this.a.restrictions,this.o),b=Bx(this.g,this.a.defaultBandwidthEstimate);this.o.length&&!a.length&&(this.f.warn("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),a=Dx(null,this.o),a=[a[0]]);var c=a[0]||null;a=_.t(_.Qo(a));for(var d=a.next();!d.done;d=a.next()){var e=d.value;d=e.item;var f=isNaN(this.m)||0===this.m?1:Math.abs(this.m),g=f*d.bandwidth,k=g/this.a.bandwidthDowngradeTarget;e=f*(e.next||{bandwidth:Infinity}).bandwidth/
this.a.bandwidthUpgradeTarget;this.f.debug("Bandwidth ranges:",(g/1E6).toFixed(3),(k/1E6).toFixed(3),(e/1E6).toFixed(3));b>=k&&b<=e&&(c=d)}this.h=Date.now();return c};_.h.enable=function(){this.j=!0};_.h.disable=function(){this.j=!1};
_.h.segmentDownloaded=function(a,b){this.f.debug("Segment downloaded:","deltaTimeMs\x3d"+a,"numBytes\x3d"+b,"lastTimeChosenMs\x3d"+this.h,"enabled\x3d"+this.j);var c=this.g;if(!(16E3>b)){var d=8E3*b/a,e=a/1E3;c.a+=b;_.zn(c.f,e,d);_.zn(c.g,e,d)}if(null!=this.h&&this.j)a:{this.f.debug("Suggesting Streams...");if(!this.A){if(!(128E3<=this.g.a)){this.f.debug("Still waiting for a good estimate...");break a}this.A=!0;if(this.a.useSwitchIntervalForInitialSwitch&&Date.now()-this.h<1E3*this.a.switchInterval){this.f.debug("Skipping initial estimation switch due to switch interval...");
break a}}else if(Date.now()-this.h<1E3*this.a.switchInterval){this.f.debug("Still within switch interval...");break a}c=this.chooseVariant();this.f.debug("Calling switch_(), bandwidth\x3d"+Math.round(Bx(this.g,this.a.defaultBandwidthEstimate)/1E3)+" kbps");this.w(c)}};_.h.playbackRateChanged=function(a){this.m=a};_.h.getBandwidthEstimate=function(){return Bx(this.g,this.a.defaultBandwidthEstimate)};_.h.setVariants=function(a){this.o=a};_.h.configure=function(a){this.a=a};
_.h.reset=function(){this.A=!1;this.g=new Ax;var a=this.chooseVariant();a&&this.w(a)};Ex.prototype.clear=function(){this.a.clear()};Hx.prototype.add=function(a){if(Kx(this.f,a))return this.a.add(a),!0;_.C("Rejecting variant - not compatible with root.");return!1};Hx.prototype.values=function(){return this.a.values()};Mx.prototype.create=function(a){var b=this,c=a.filter(function(d){return Kx(b.a,d)});return c.length?new Hx(c[0],c):this.f.create(a)};
Lx.prototype.create=function(a){var b=[];b=Nx(a,this.g);var c=a.filter(function(d){return d.primary});b=b.length?b:c.length?c:a;this.f&&(a=Ox(b,this.f),a.length?b=a:_.C("No exact match for variant role could be found."));this.a&&(a=cx(b,this.a),a.length?b=a:_.C("No exact match for the channel count could be found."));a=new Hx(b[0]);b=_.t(b);for(c=b.next();!c.done;c=b.next())c=c.value,Kx(a.f,c)&&a.add(c);return a};Rx.prototype.getState=function(){return this.a};var Qx=0,Px=1;Tx.prototype.release=function(){this.h.release()};Ux.prototype.release=function(){this.a=this.g=null;this.f=function(){}};Ux.prototype.m=function(a){var b=this.a,c=this.g.periods;a=dv(c,a)||c[0];b!=a&&this.f(a);this.a=a};Wx.prototype.release=function(){this.f&&(this.f.stop(),this.f=null);this.a=null};Wx.prototype.set=function(a){this.g=a;Xx(this)};Zx.prototype.release=function(){this.g=null;this.f=function(){}};cy.prototype.release=function(){this.g&&(this.g.release(),this.g=null);null!=this.m&&(this.m.stop(),this.m=null);this.f&&(this.f.release(),this.f=null);this.a=this.C=this.B=null;this.j=!1};cy.prototype.Ld=function(){this.o=!0;by(this)};gy.prototype.release=function(){this.f&&(this.f.release(),this.f=null);null!=this.g&&(this.g.release(),this.g=null);this.m=function(){};this.a=null;this.h=function(){};this.j=!1};dy.prototype.release=function(){this.a&&(this.a.stop(),this.a=null);this.f=null};oy.prototype.release=function(){this.g&&(this.g.release(),this.g=null);this.j&&(this.j.release(),this.j=null);this.o&&(this.o.stop(),this.o=null);this.h=this.g=this.a=this.m=null;this.A=function(){}};_.sy.prototype.destroy=function(){for(var a=_.t(this.h.values()),b=a.next();!b.done;b=a.next())Iy(b.value);this.h.clear();this.w.clear();this.m=this.o=this.I=this.g=this.f=null;this.D=[];this.j=!0;return Promise.resolve()};
_.sy.prototype.start=function(){var a=this,b,c,d;return _.y(function(e){if(1==e.a){b=a.f.sb();c=xy(a,b);d=a.f.Le(a.g.periods[c]);if(!d.variant&&!d.text)throw a.a.error("init: no Streams chosen"),new _.K(_.L,5,5005);a.G=!d.variant&&!!d.text;return _.v(e,My(a,d.variant?d.variant.audio:null,d.variant?d.variant.video:null,d.text,b),2)}if(a.j)return e["return"]();a.a.debug("init: completed initial Stream setup");a.f&&a.f.Jj&&(a.a.debug("init: calling onInitialStreamsSetup()..."),a.f.Jj());_.x(e)})};
_.sy.prototype.L=function(a,b,c,d){var e=Tu(d.F),f=Tu(d.F),g=_.Kj(d.F),k=_.Kj(d.F),l=_.Kj(d.F),m=_.Kj(d.F);d=_.Nj(d.F,d.F.ya()-d.F.getPosition());a=a.startTime+b.startTime+k/g;if(c.includes(e))if("urn:mpeg:dash:event:2012"==e)this.f.pg();else this.f.onEvent(new _.M("emsg",{detail:{startTime:a,endTime:a+l/g,schemeIdUri:e,value:f,timescale:g,presentationTimeDelta:k,eventDuration:l,id:m,messageData:d}}))};
_.sy.prototype.P=function(a){var b=this,c=!1,d=0;(new _.Yj).O(_.td,_.Zj).O(_.se,_.Zj).O(_.pd,_.Zj).O("minf",_.Zj).O("stbl",_.Zj).ba("stsd",_.ak).O("encv",function(e){e.F.skip(78);_.Zj(e)}).O("pasp",function(e){d=e.start+e.ve;var f=_.Kj(e.F),g=_.Kj(e.F);c=f!==g;b.a.debug("hSpacing\x3d"+f+", vSpacing\x3d"+g+", updatePASP\x3d"+c);e.fb.stop()}).parse(a.data);c&&(a=new _.Cj(new DataView(a.data)),a.seek(d),_.S(a,1),_.S(a,1))};_.u(jz,_.tj);_.h=jz.prototype;_.h.init=function(a,b){var c=a.getMedia();_.tj.prototype.init.call(this,a,b);pz(this,c)};_.h.namespace=function(){return Hu};_.h.If=function(){return new kx};_.h.getState=function(){return this.Z};_.h.getDrmInfo=function(){return this.j?this.j.getDrmInfo():null};
_.h.unload=function(){var a=this;qx(this,!1);this.Qc=!1;if(this.w){var b=this.getTrackManager();b&&b.release();return this.C==mz?Promise.resolve():rz(this).then(function(){a.log.debug(_.ab,a.w);a.w=null;a.Ee=0;a.xc=null;a.L=null})}return Promise.resolve()};_.h.release=function(){var a=this;return _.tj.prototype.release.call(this).then(function(){return a.unload()}).then(function(){return lz(a,_.Sn)})};
_.h.getBufferInfo=function(a){if(this.G){var b=Ow(this.G),c=new _.Nh(void 0,a);switch(a){case _.mh:return b.video?b.video:c;case _.P:return b.audio?b.audio:c;case _.N:return b.text?b.text:c}return b.total?b.total:c}return this.Rc?(b=qv(this.Rc),cv(b,a)):_.tj.prototype.getBufferInfo.call(this,a)};_.h.getPosition=function(){return this.o?qy(this.o):_.tj.prototype.getPosition.call(this)};_.h.getPresentationStartTime=function(){return this.f?this.f.presentationTimeline.getPresentationStartTime()||0:0};
_.h.getDuration=function(){return this.f?this.f.presentationTimeline.getDuration():Infinity};_.h.destroy=function(){var a=this;return _.y(function(b){if(1==b.a)return _.v(b,_.tj.prototype.destroy.call(a),2);if(3!=b.a){if(a.C==mz)return b["return"]();a.log.debug("Destroying player...");a.C=mz;return _.v(b,oz(a),3)}a.m&&(a.m.release(),a.m=null);a.g=null;_.x(b)})};
_.h.load=function(a){var b=this,c,d,e,f;return _.y(function(g){switch(g.a){case 1:if(b.C==mz)return g["return"](Promise.reject(new _.K(_.L,7,7E3)));b.D=new _.al;b.De=Date.now()/1E3;lz(b,_.ao);b.w=_.xl(a);_.sj(a)&&(b.configuration=_.rj(b.pd,a));b.log.info(_.Ka,b.configuration);b.log.info(_.Wa,b.w);(c=b.getTrackManager())&&c.load();d=b.getSurface().getMedia();d.loop=!!b.configuration.loop;_.A.N(b.configuration.volume)||b.setVolume(b.configuration.volume);_.A.N(b.configuration.muted)||b.setMuted(b.configuration.muted);
b.B&&b.B.configure(b.configuration.manifest);b.j&&Dz(b);if(b.a){b.a.m=b.configuration.streaming;try{for(var k=_.t(b.f.periods),l=k.next();!l.done;l=k.next())Qz(b,l.value)}catch(n){b.onError(n)}l=uy(b.a);var m=vy(b.a);k=yz(b)||b.f.periods[0];l=fx(l,m,k.variants);b.g&&l&&l.allowedByApplication&&l.allowedByKeySystem?Cz(b,k.variants):(b.log.debug("Choosing new streams after changing configuration"),Az(b,k))}b.g&&(b.g.configure(b.configuration.abr),b.configuration.abr.enabled&&!b.P?b.g.enable():b.g.disable());
e=b.w[b.getSourceIndex()];_.kf(g,2);return _.v(g,pz(b,d),4);case 4:return _.v(g,qz(b,d),5);case 5:return _.v(g,tz(b,e),6);case 6:return _.v(g,xz(b,e),7);case 7:return _.v(g,Fz(b),8);case 8:return _.v(g,Rz(b),9);case 9:_.lf(g,0);break;case 2:throw f=_.mf(g),b.onError(f),f;}})};_.h.isLive=function(){return this.f?this.f.presentationTimeline.isLive():!1};_.h.tg=function(){this.log.debug("User seeking finished");Gz(this);Hz(this)};
_.h.getSeekRange=function(){if(this.f){var a=this.f.presentationTimeline;return{start:Xu(a,0),end:Wu(a)}}return{start:0,end:0}};_.h.getPlaybackRate=function(){if(this.yc){var a=this.yc;a=a.h?0:a.g}else a=0;return a};
_.h.setPlaybackRate=function(a){if(0==a)this.log.warn("A trick play rate of 0 is unsupported!");else if(this.C==iz){this.yc.set(a);this.g.playbackRateChanged(a);var b=this.a,c=1<Math.abs(a);if(a=b.h.get(_.Ee)){var d=a.stream;if(d)if(b.a.debug("setTrickPlay",c),c)(c=d.trickModeVideo)&&!a.Nb&&(b.a.debug("Engaging trick mode stream",c),_.By(b,c,!1,0),a.Nb=d);else if(d=a.Nb)b.a.debug("Restoring non-trick-mode stream",d),a.Nb=null,_.By(b,d,!0,0)}}};
_.h.ea=function(){if(this.f&&this.o){var a=yz(this);if(null==a)a=null;else{if(!Gx(this.R,a).text){var b=_.ex(a.textStreams,this.ja,this.Ma);b.length&&(b=b[0],Gx(this.R,a).text=b)}a=Gx(this.R,a).text}b=[];for(var c=_.t(eA(this)),d=c.next();!d.done;d=c.next()){d=d.value;var e=ax(d);e.active=d==a;b.push(e)}return b}return[]};_.h.getThumbnailStreams=function(){if(this.f&&this.o){var a=yz(this);return a?a.thumbStreams:[]}return[]};
_.h.getStats=function(){if(this.C!=iz)return _.bl();Hz(this);var a=this.h;if(a.getVideoPlaybackQuality){a=a.getVideoPlaybackQuality();var b=this.D,c=Number(a.totalVideoFrames);b.h=Number(a.droppedVideoFrames);b.g=c}if(this.C==iz){if(a=Tz(this))this.D.A=a.bandwidth;a&&a.video&&(b=this.D,c=a.video.height||NaN,b.j=a.video.width||NaN,b.f=c);a=this.g.getBandwidthEstimate();this.D.m=a}return this.D.getStats()};
_.h.getTimelineCues=function(){return this.vc?_.df(this.vc.cues()).concat().map(function(a){return{schemeIdUri:a.schemeIdUri,value:a.value,startTime:a.startTime,endTime:a.endTime,id:a.id,eventElement:a.eventElement,type:a.type}}):[]};_.h.resetAbr=function(){this.g&&this.g.reset()};
_.h.addTextTrack=function(a,b,c,d,e,f){var g=this,k,l,m,n,p,q,r,w,B;return _.y(function(E){if(1==E.a){if(g.C!=iz)throw g.log.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");k=yz(g);l=_.hl;m=g.f.periods.indexOf(k);n=m+1;p=n>=g.f.periods.length?g.f.presentationTimeline.getDuration():g.f.periods[n].startTime;q=p-k.startTime;if(Infinity==q)throw new _.K(1,4,4040);r=new _.fo(1,0,q,function(){return[a]},0,null,0);w={id:g.Bg++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),
findSegmentPosition:function(){return 1},getSegmentReference:function(F){return 1==F?r:null},adjustSegmentDurations:function(){},getDuration:function(){return q},initSegmentReference:null,mimeType:d,codecs:e||"",kind:c,encrypted:!1,keyId:null,language:b,label:f||null,type:l.TEXT,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null};g.Ed.add(w);k.textStreams.push(w);return _.v(E,Ay(g.a,w),2)}if(B=_.ty(g.a,_.oe))Gx(g.R,k).text=B;g.Ed["delete"](w);g.log.debug("Choosing new streams after adding a text stream");
Az(g,k);Bz(g);return E["return"](ax(w))})};_.h.Xh=function(a){this.log.debug(_.Ju,a);try{this.log.debug("onChooseStreams_, choosing variant from ",a.variants);this.log.debug("onChooseStreams_, choosing text from ",a.textStreams);var b=cA(this,a);this.log.debug("onChooseStreams_, chose variant ",b.variant);this.log.debug("onChooseStreams_, chose text ",b.text);return b}catch(c){return this.onError(c),{variant:null,text:null}}};
_.h.Wh=function(){this.log.debug("canSwitch_");this.P=!1;this.configuration.abr.enabled&&this.g.enable();this.aa&&(Cy(this.a,this.aa,this.vg,this.cg),this.aa=null);this.Y&&(_.By(this.a,this.Y,!0,0),this.Y=null)};_.h.Yh=function(){this.B&&this.B.update&&this.B.update()};_.h.Uj=function(){this.o&&this.o.j.Ld()};
_.h.fh=function(a,b){b=void 0===b?!1:b;var c=yz(this),d=c.variants.some(function(k){var l=!1,m=k[a.type];m&&(l=k.allowedByApplication&&m.id!==a.id,a.type===_.$b&&(l=l&&m.language===a.language));return l})&&(this.oa()||b);if(d){for(var e=_.t(c.variants),f=e.next();!f.done;f=e.next()){f=f.value;var g=f[a.type];g&&g.id===a.id&&(f.allowedByApplication=!1)}Bz(this);!this.oa()&&b&&(this.configuration.abr.enabled=!0,this.g.enable());Az(this,c)}return d};
_.h.Gj=function(){this.log.debug("endOfStream called by streaming engine");this.Qc=!0};_.h.onError=function(a){if(this.C!==mz&&7001!==a.code){var b=new _.M(_.Zc,{detail:a});a.a===_.L&&lz(this,_.kl);this.trigger(b);b.defaultPrevented&&(b.a=!0)}};
_.h.ke=function(a){a.type===_.Rc?this.dispatchEvent(new _.M(_.Rc,{keySystem:this.j.keySystem(),Ii:_.Dk(this.j)})):"largegap"!==a.type&&(a.type===_.Me?sz(this):"emsg"!==a.type&&(a instanceof _.M?this.dispatchEvent(a):this.log.debug("Unhandled/ignored event",a.type)))};_.h.oa=function(){return this.configuration.abr.enabled};
_.h.wk=function(a){var b=this,c,d,e,f,g,k,l,m;return _.y(function(n){switch(n.a){case 1:if(!b.Fa)return n["return"]();b.log.info("Attempt to switch CDN.");c=b.getLoadedSource();d=b.oa();return _.v(n,b.Fa(c.url,a),2);case 2:e=n.f;if(!e)return n["return"]();f=_.A.Ta(b.getLoadedSource(),{url:e});d&&b.g.disable();return _.v(n,fz(b.a),3);case 3:g=Tz(b);case 4:return k=!1,_.kf(n,7),b.log.info("Switching CDN to "+f.url+"."),_.v(n,fA(b,f,g),9);case 9:_.lf(n,6);break;case 7:return l=_.mf(n),b.log.info("Switch failed"),
_.v(n,b.Fa(f.url,a),10);case 10:if(m=n.f)f.url=m,k=!0;else throw l;case 6:k?n.H(4):(d&&b.g.enable(),cz(b.a,!0),b.w[b.getSourceIndex()]=f,a.j=!0,b.trigger(new _.M(_.pc,{newManifest:f.url})),_.x(n))}})};var mz=0,hz=1,iz=2,zz=[Ku,_.ed];gA.prototype.canPlay=function(a){if(_.vi())return 0;var b=a.type||"";if(b===_.tl&&a.drmProtected)return 0;var c=_.pi();a=_.To.U(a.url,b);return c&&a?_.ti(2)||_.wi()?1:2:0};gA.prototype.create=function(){return new jz};gA.prototype.create=gA.prototype.create;
gA.prototype.canPlay=gA.prototype.canPlay;_.Rg(new gA);};
if(typeof(module)!="undefined"&&module.exports){var x=require("./cl.core.min.js");_ = x._;(f.call(g,this));module.exports=g;}
else if (typeof(define)!="undefined"&&define.amd) {define(["./cl.core.min"], function(c){_=c._;(f.call(g,this));return g;});}
else{_=this.clpp._;(f.call(g,this));}
})();
