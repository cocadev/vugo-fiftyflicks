(function(){var g={}; var _ = _ || {};
var f=function(window){/*

 Copyright 2016 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
var sD="BANDWIDTH",tD="CLOSED-CAPTIONS",uD="EXT-X-BYTERANGE",vD="EXT-X-DISCONTINUITY",wD="EXT-X-DISCONTINUITY-SEQUENCE",xD="EXT-X-ENDLIST",yD="EXT-X-MEDIA-SEQUENCE",zD="EXT-X-PLAYLIST-TYPE",AD="EXT-X-STREAM-INF",BD="EXT-X-TARGETDURATION",CD="GROUP-ID",DD="Guessing audio-only",ED="SUBTITLES",FD="URI",GD=function(a,b){b=void 0===b?0:b;return b+10<=a.length&&73===a[b]&&68===a[b+1]&&51===a[b+2]&&255>a[b+3]&&255>a[b+4]&&128>a[b+6]&&128>a[b+7]&&128>a[b+8]&&128>a[b+9]?!0:!1},HD=function(a,b,c,d){this.f=
a;this.type=b;this.La=c;this.a=d||null},ID=function(a,b,c,d){this.id=a;this.name=b;this.attributes=c;this.value=void 0===d?null:d},JD=function(a,b){this.name=a;this.value=b},KD=function(a,b,c){return(a=a.getAttribute(b))?a.value:c||null},LD=function(a,b){var c=a.getAttribute(b);if(!c)throw new _.K(_.L,4,4023,b);return c.value},MD=function(a,b){this.La=b;this.a=a},ND=function(a,b){return a.filter(function(c){return c.name==b})},OD=function(a,b){return a.filter(function(c){return LD(c,"TYPE")===b})},
PD=function(a,b){var c=ND(a,b);return c.length?c[0]:null},QD=function(a){var b=void 0===b?0:b;return(a=PD(a,yD))?Number(a.value):b},RD=function(a,b){return _.Ok([a],[b])[0]},SD=function(){this.a=0},XD=function(a,b,c){b=_.Tf(b);b=b.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim();var d=b.split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(d[0]))throw new _.K(_.L,4,4015);b=0;for(var e=!0,f=_.t(d),g=f.next();!g.done;g=f.next())if(g=g.value,g=g.trim(),!g.length||/^#(?!EXT)/m.test(g)||e)e=!1;else if(g=TD(a,g),--a.a,
UD.includes(g.name)){b=1;break}else g.name==AD&&(e=!0);f=[];e=!0;g=_.t(_.Qo(d));for(var k=g.next();!k.done;k=g.next()){var l=k.value;k=l.we;var m=l.item;l=l.next;m=m.trim();if(!m.length||/^#(?!EXT)/m.test(m)||e)e=!1;else{m=TD(a,m);if(VD.includes(m.name)){if(1!=b)throw new _.K(_.L,4,4017);d=d.splice(k,d.length-k);a=WD(a,c,d,f);return new HD(c,b,f,a)}f.push(m);m.name==AD&&(m.attributes.push(new JD(FD,l)),e=!0)}}return new HD(c,b,f)},WD=function(a,b,c,d){var e=[],f=[];c.forEach(function(g){/^(#EXT)/.test(g)?
(g=TD(a,g),UD.includes(g.name)?d.push(g):f.push(g)):/^#(?!EXT)/m.test(g)||(g=RD(b,g.trim()),e.push(new MD(g,f)),f=[])});return e},TD=function(a,b){var c=a.a++,d=b.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!d)throw new _.K(_.L,4,4016,{invalidTag:b});var e=d[1],f=d[2];d=[];var g;if(f){f=new _.Bn(f);var k;(k=_.Cn(f,/^([^,=]+)(?:,|$)/g))&&(g=k[1]);for(var l=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;k=_.Cn(f,l);)d.push(new JD(k[1],k[2]||k[3]))}return new ID(c,e,d,g)},$D=function(){var a=this;this.h=this.j=null;
this.ja=1;this.w=new Map;this.da=new Set;this.f=new Map;this.g=null;this.B="";this.L=new SD;this.aa=0;this.A=new _.th(function(){YD(a)});this.m=ZD;this.I=null;this.R=0;this.Y=Infinity;this.C=new _.jj;this.Z=[];this.K=new Map;this.G=!1;this.o=new Map;this.P=null;this.a=new _.G("clpp.hls.HlsParser");this.D=new Map;this.J=new Map},eE=function(a,b){var c,d,e,f,g,k,l,m;return _.y(function(n){if(1==n.a)return c=aE,d=b.Rg,_.v(n,bE(a,d),2);if(3!=n.a){e=n.f;f=XD(a.L,e.data,e.uri);if(1!=f.type)throw new _.K(_.L,
4,4017);g=b.stream;return _.v(n,cE(a,b.Vd,f,g.mimeType,g.codecs,g.keyInfo||null,b.Fi),3)}k=n.f;b.hb.replace(k);l=k[k.length-1];if(m=PD(f.La,xD))dE(a,c.VOD),a.g.Qb(l.endTime);_.x(n)})},iE=function(a,b){var c,d,e,f,g,k,l,m,n,p,q,r,w,B,E,F,D,H,O,R,T;return _.y(function(ya){if(1==ya.a){c=XD(a.L,b,a.B);if(1===c.type){a.D.set(a.B,c);d=c.a[0].a;e=_.hl;f=new _.Xi(d);g=f.sa.split(".").pop();k=fE[e.AUDIO][g];l=fE[e.VIDEO][g];m="";l?m="avc1.42E01E":k&&(m="mp4a.40.2");var ha=a.L,Ra=a.B,Pa=m,Ha=[],Sa=[];Sa.push(new JD(sD,
"0"));Sa.push(new JD(FD,Ra));Pa.length&&Sa.push(new JD("CODECS",Pa));Ha.push(new ID(ha.a++,AD,Sa));c=new HD(Ra,0,Ha)}return _.v(ya,gE(a,c.La),2)}n=ya.f;if(!a.j)throw new _.K(_.L,7,7001);a.j.filterAllPeriods([n]);p=Infinity;q=0;r=Infinity;w=_.t(a.f.values());for(B=w.next();!B.done;B=w.next())E=B.value,p=Math.min(p,E.He),q=Math.max(q,E.He),E.stream.type!=_.oe&&(r=Math.min(r,E.duration));a.m!=ZD?(a.g=new _.go(0,3*a.R,!0),a.g.f=!1):(a.g=new _.go(null,0,!0),a.g.f=!0);hE(a);if(a.m!=ZD){a.aa=a.Y;F=aE;a.m!==
F.LIVE||isNaN(a.h.availabilityWindowOverride)||(a.g.lc=a.h.availabilityWindowOverride);for(D=0;95443.7176888889<=q;)D+=95443.7176888889,q-=95443.7176888889;if(D)for(a.a.debug("Offsetting live streams by",D,"to compensate for rollover"),H=_.t(a.f.values()),B=H.next();!B.done;B=H.next())O=B.value,95443.7176888889>O.He?(a.a.debug("Offset applied to",O.stream.type),O.hb.offset(D)):a.a.debug("Offset NOT applied to",O.stream.type)}else for(a.g.Qb(r),a.g.offset(-p),R=_.t(a.f.values()),B=R.next();!B.done;B=
R.next())T=B.value,T.hb.offset(-p),_.oo(T.hb,r);a.I={presentationTimeline:a.g,periods:[n],offlineSessionIds:[],minBufferTime:0};_.x(ya)})},gE=function(a,b){var c,d,e,f;return _.y(function(g){switch(g.a){case 1:c=ND(b,"EXT-X-MEDIA");d=ND(b,AD);for(var k=_.t(d),l=k.next();!l.done;l=k.next()){var m=l.value,n=KD(m,"AUDIO");l=KD(m,"VIDEO");var p=KD(m,ED);m=jE(a,m);if(p){var q=kE(_.oe,m);a.o.set(p,q);p=m.indexOf(q);-1<p&&m.splice(p,1)}n&&(p=lE(_.$b,m),a.o.set(n,p));l&&(n=lE(_.Ee,m),a.o.set(l,n))}return _.v(g,
mE(a,c),2);case 2:k=OD(c,tD);k=_.t(k);for(l=k.next();!l.done;l=k.next())l=l.value,n=KD(l,"LANGUAGE")||_.ue,n=_.un(n),m=LD(l,CD),l=LD(l,"INSTREAM-ID"),a.K.get(m)||a.K.set(m,new Map),a.K.get(m).set(l,n);return _.v(g,nE(a,d),3);case 3:return e=g.f,_.v(g,oE(a,c),4);case 4:return f=g.f,g["return"]({startTime:0,variants:e,textStreams:f,thumbStreams:[]})}})},oE=function(a,b){var c,d,e,f,g,k,l,m,n,p,q,r;return _.y(function(w){if(1==w.a)return c=OD(b,ED),d=c.map(function(B){var E,F;return _.y(function(D){if(1==
D.a)return _.kf(D,2),_.v(D,pE(a,B),4);if(2!=D.a)return E=D.f,D["return"](E.stream);F=_.mf(D);throw F;})}),_.v(w,Promise.all(d),2);e=w.f;f=_.t(c);for(g=f.next();!g.done;g=f.next())if(k=g.value,l=LD(k,CD),m=a.o.get(l))if(n=a.w.get(l))for(p=_.t(n),q=p.next();!q.done;q=p.next())r=q.value,r.stream.codecs=m;return w["return"](e.filter(function(B){return B}))})},mE=function(a,b){var c;return _.y(function(d){if(1==d.a)return b=b.filter(function(e){var f=KD(e,FD)||"";return KD(e,"TYPE")!==ED&&""!==f}),b.length?
_.v(d,pE(a,b[0]),2):d.H(2);c=b.slice(1).map(function(e){return pE(a,e)});return _.v(d,Promise.all(c),0)})},nE=function(a,b){var c,d,e,f,g,k,l,m,n,p,q;return _.y(function(r){if(1==r.a){c=_.Nk;d=function(w){var B,E,F,D,H,O,R;return _.y(function(T){return 1==T.a?(B=KD(w,"FRAME-RATE"),E=Number(LD(w,sD)),F=KD(w,"RESOLUTION"),D=_.t(F?F.split("x"):[null,null]),H=D.next().value,O=D.next().value,_.v(T,qE(a,w,F,B),2)):(R=T.f)?T["return"](rE(a,R.audio,R.video,E,H,O,B)):T["return"]([])})};e=0;f=Infinity;for(g=
0;g<b.length;++g)k=Number(LD(b[g],sD)),k<f&&(f=k,e=g);l=b.splice(e,1).pop();return _.v(r,d(l),2)}if(3!=r.a)return m=r.f,n=b.map(d),_.v(r,Promise.all(n),3);p=r.f;p.splice(e,0,m);q=p.reduce(c.me,[]);return r["return"](q.filter(c.eb))})},qE=function(a,b,c,d){var e,f,g,k,l,m,n,p,q,r,w,B,E,F;return _.y(function(D){if(1==D.a)return e=_.hl,f=jE(a,b),g=KD(b,"AUDIO"),k=KD(b,"VIDEO"),m=(l=g||k)&&a.w.has(l)?a.w.get(l):[],n={audio:g?m:[],video:k?m:[]},a.a.debug("Guessing stream type for",b.toString()),q=!1,r=
LD(b,FD),w=n.audio.find(function(H){return H.Vd===r}),B=kE(e.VIDEO,f),E=c||d||B,1!==f.length||E?!m.length&&1<f.length?(a.a.debug("Guessing multiplexed audio+video"),p=e.VIDEO,f=[f.join(",")]):n.audio.length&&w?(a.a.debug(DD),p=e.AUDIO,q=!0):n.video.length?(a.a.debug(DD),p=e.AUDIO):(a.a.debug("Guessing video-only"),p=e.VIDEO):(p=e.AUDIO,a.a.debug(DD)),q?D.H(2):_.v(D,sE(a,b,f,p),3);2!=D.a&&(F=D.f);if(F)n[F.stream.type]=[F];else if(null===F)return a.a.debug("streamInfo is null"),D["return"](null);tE(n);
return D["return"](n)})},tE=function(a){a=_.t(a.audio.concat(a.video));for(var b=a.next();!b.done;b=a.next()){b=b.value;var c=b.stream.codecs.split(",");c=c.filter(function(d){return"mp4a.40.34"!=d});b.stream.codecs=c.join(",")}},rE=function(a,b,c,d,e,f,g){c.forEach(function(E){if(E=E.stream)E.width=Number(e)||void 0,E.height=Number(f)||void 0,E.frameRate=Number(g)||void 0});b.length||(b=[null]);c.length||(c=[null]);var k=[];b=_.t(b);for(var l=b.next();!l.done;l=b.next()){l=l.value;for(var m=_.t(c),
n=m.next();!n.done;n=m.next()){var p=n.value;n=l?l.stream:null;var q=p?p.stream:null,r=l?l.drmInfos:null,w=p?p.drmInfos:null;p=(p?p.Vd:"")+" - "+(l?l.Vd:"");var B=void 0;if(n&&q)if(r.length&&w.length?0<_.Mk(r,w).length:1)B=_.Mk(r,w);else{a.a.warn("Incompatible DRM info in HLS variant.  Skipping.");continue}else n?B=r:q&&(B=w);a.da.has(p)?a.a.debug("Skipping variant which only differs in text streams."):(n=uE(a,n,q,d,B),k.push(n),a.da.add(p))}}return k},uE=function(a,b,c,d,e){return{id:a.ja++,language:b?
b.language:_.ue,primary:!!b&&b.primary||!!c&&c.primary,audio:b,video:c,bandwidth:d,drmInfos:e,allowedByApplication:!0,allowedByKeySystem:!0}},pE=function(a,b){var c,d,e,f,g,k,l,m,n,p,q,r,w;return _.y(function(B){if(1==B.a){c=LD(b,CD);d="";e=LD(b,"TYPE").toLowerCase();f=_.hl;e==_.me&&(e=f.TEXT);e!==f.TEXT&&c&&a.o.has(c)&&(d=a.o.get(c));g=LD(b,FD);if(a.f.has(g))return B["return"](a.f.get(g));k=_.un(KD(b,"LANGUAGE",_.ue));l=KD(b,"NAME");m=b.getAttribute("DEFAULT");n=b.getAttribute("AUTOSELECT");p=KD(b,
"CHANNELS");q=e==_.$b?p?parseInt(p.split("/")[0],10):null:null;r=!!m&&!!n;return _.v(B,vE(a,g,d,e,k,r,l,q,null),2)}w=B.f;if(null==w)return B["return"](null);a.w.has(c)?a.w.get(c).push(w):a.w.set(c,[w]);if(a.f.has(g))return B["return"](a.f.get(g));a.f.set(g,w);return B["return"](w)})},jE=function(a,b){var c=KD(b,"CODECS","avc1.42E01E,mp4a.40.2").split(/\s*,\s*/),d=new Set,e=[];c=_.t(c);for(var f=c.next();!f.done;f=c.next()){f=f.value;var g=_.Eg(f)[0];d.has(g)?a.a.debug("Ignoring duplicate codec"):
(e.push(f),d.add(g))}return e},sE=function(a,b,c,d){var e,f,g,k,l,m;return _.y(function(n){if(1==n.a){e=_.hl;f=LD(b,FD);if(a.f.has(f))return n["return"](a.f.get(f));g=KD(b,tD);k=null;d==e.VIDEO&&g&&"NONE"!=g&&(k=a.K.get(g));l=lE(d,c);return _.v(n,vE(a,f,l,d,_.ue,!1,null,null,k),2)}m=n.f;if(null==m)return n["return"](null);if(a.f.has(f))return n["return"](a.f.get(f));a.f.set(f,m);return n["return"](m)})},vE=function(a,b,c,d,e,f,g,k,l){var m,n,p,q,r,w,B,E,F,D,H,O,R,T,ya,ha,Ra,Pa,Ha,Sa,Ca,rb,sb,tb,Ya,
Ac,Gb,Wc;return _.y(function(Bb){switch(Bb.a){case 1:m=RD(a.B,b);p=null;if(a.m==ZD&&a.D.has(m)){n=a.D.get(m);a.D["delete"](m);Bb.H(2);break}return _.v(Bb,bE(a,m),3);case 3:q=Bb.f,m=q.uri,n=XD(a.L,q.data,m);case 2:if(1!=n.type)throw new _.K(_.L,4,4017);r=[];n.a.forEach(function(Vb){Vb=ND(Vb.La,"EXT-X-KEY");r.push.apply(r,Vb)});w=!1;B=[];E=null;F=_.t(r);for(D=F.next();!D.done;D=F.next())H=D.value,O=LD(H,"METHOD"),R=KD(H,"KEYFORMAT","identity"),"NONE"!=O&&("AES-128"==O?(T=KD(H,"IV",""),ya=RD(a.B,LD(H,
FD)),p={method:"AES-128",url:ya,iv:T?_.Th((T||"0x").slice(2)):null},a.G=!0):(w=!0,(Ra=(ha=wE[R])?ha(H):null)?(Ra.keyIds.length&&(E=Ra.keyIds[0]),B.push(Ra)):a.a.warn("Unsupported HLS KEYFORMAT",R)));if(w&&!B.length&&!a.G)throw new _.K(_.L,4,4026);xE(a,n);return _.v(Bb,yE(a,d,c,n),4);case 4:return Ha=Pa=Bb.f,Sa=new Map,_.v(Bb,cE(a,b,n,Ha,c,p,Sa),5);case 5:return Ca=Bb.f,rb=Ca[0].startTime,sb=Ca[Ca.length-1].endTime,tb=sb-rb,Ya=new _.mo(Ca),Ac=zE(n,p),Gb=void 0,d==_.oe&&(Gb=_.le),Wc={id:a.ja++,originalId:g,
createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:Ya.find.bind(Ya),getSegmentReference:Ya.get.bind(Ya),adjustSegmentDurations:Ya.Ac.bind(Ya),getDuration:Ya.getDuration.bind(Ya),initSegmentReference:Ac,mimeType:Ha,codecs:c,kind:Gb,encrypted:w,keyId:E,language:e,label:g,type:d,primary:f,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:[],channelsCount:k,closedCaptions:l,keyInfo:p},Bb["return"]({stream:Wc,hb:Ya,drmInfos:B,
Vd:b,Rg:m,He:rb,dl:sb,duration:tb,Fi:Sa})}})},xE=function(a,b){var c=PD(b.La,zD),d=PD(b.La,xD);d=c&&"VOD"==c.value||d;c=c&&"EVENT"==c.value&&!d;c=!d&&!c;d?dE(a,ZD):(c?dE(a,AE):dE(a,BE),d=CE(b.La,BD),d=Number(d.value),a.R=Math.max(d,a.R),a.Y=Math.min(d,a.Y))},zE=function(a,b){var c=ND(a.La,"EXT-X-MAP");if(!c.length)return null;if(1<c.length)throw new _.K(_.L,4,4020);var d=c[0];c=LD(d,FD);var e=RD(a.f,c);c=0;var f=null;if(d=KD(d,"BYTERANGE"))c=d.split("@"),d=Number(c[0]),c=Number(c[1]),f=c+d-1;return new _.eo(function(){return[e]},
c,f,b)},DE=function(a,b,c,d,e,f){var g=b.La,k=b.a;b=CE(g,"EXTINF").value.split(",");b=d+Number(b[0]);var l=0,m=null;if(g=PD(g,uD))l=g.value.split("@"),g=Number(l[0]),l=l[1]?Number(l[1]):a.wa+1,m=l+g-1;f&&!f.iv&&(f.iv=_.Wh(new Uint8Array(12),new Uint8Array([c>>24&255,c>>16&255,c>>8&255,c&255])));return new _.fo(c,d,b,function(){return[k]},l,m,e,f)},hE=function(a){a.g&&(a.Z.forEach(function(b){_.io(a.g,b,0)}),a.Z=[])},cE=function(a,b,c,d,e,f,g){var k,l,m,n,p,q,r,w,B,E,F,D,H,O,R,T,ya,ha,Ra,Pa,Ha,Sa;
return _.y(function(Ca){switch(Ca.a){case 1:k=c.a;l=zE(c,f);m=QD(c.La);if(null!==a.P){Ca.H(2);break}n=a;return _.v(Ca,HE(a,b,l,k[0],m,f,d,e),3);case 3:n.P=Ca.f;case 2:p=a.P;q=k[0].a;a.a.debug("First segment",q.split("/").pop(),"starts at",p);w=(r=PD(c.La,wD))?Number(r.value):0;g.has(w)||g.set(w,m);if(!r)for(;g.has(w+1)&&g.get(w+1)<m;)w++;B=a.J.get(w)||0;E=[];F=function(rb){return _.Qo(rb)};D=_.t(F(k));H=D.next();case 4:if(H.done){Ca.H(6);break}R=O=H.value;T=R.we;ya=R.item;ha=E[E.length-1];Ra=0==T?
p:ha.endTime;Pa=m+T;Ha=PD(ya.La,vD);if(!Ha){Ca.H(7);break}w++;g.set(w,Pa);return _.v(Ca,ME(a,w,b,l,ya,Pa,f,d,e,Ra),8);case 8:B=Ca.f;case 7:Sa=DE(ha,ya,Pa,Ra,B,f);E.push(Sa);H=D.next();Ca.H(4);break;case 6:return a.Z.push(E),hE(a),Ca["return"](E)}})},ME=function(a,b,c,d,e,f,g,k,l,m){var n,p;return _.y(function(q){if(1==q.a)return n=0,a.J.has(b)?(n=a.J.get(b),q.H(2)):_.v(q,HE(a,c,d,e,f,g,k,l,!0),3);2!=q.a&&(p=q.f,n=p-m,a.a.debug("Discontinuity segment offset",n),a.J.set(b,n));return q["return"](n)})},
SE=function(a,b){var c,d,e,f,g,k,l;return _.y(function(m){switch(m.a){case 1:return c=b.a(),d=_.vn(b.Ra(),b.Ka,b.Ka+2048-1,a.h.attemptParameters),d.type=_.Jo,e=_.vn(b.Ra(),b.Ka,b.wa,a.h.attemptParameters),e.type=_.Jo,c&&(e.keyInfo=c),_.kf(m,2),f=a.G?e:d,_.v(m,RE(a,f),4);case 4:return g=m.f,m["return"](g);case 2:k=_.mf(m);if(7001==k.code||a.G)throw k;a.a.warn("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",
d.uris[0]);return _.v(m,RE(a,e),5);case 5:return l=m.f,m["return"](l)}})},HE=function(a,b,c,d,e,f,g,k,l){var m,n,p,q,r,w,B,E,F,D,H,O;return _.y(function(R){switch(R.a){case 1:m=DE(null,d,e,0,0,f);if(a.I&&!l){n=a.f.get(b);p=n.hb;if(q=p.get(m.position))return a.a.debug("Found segment start time in previous manifest"),R["return"](q.startTime);a.a.debug("Unable to find segment start time in previous manifest!")}a.a.debug("Fetching segment to find start time");if("audio/mpeg"==g)return R["return"](0);
if(g!=_.ac){R.H(2);break}return _.v(R,SE(a,m),3);case 3:return r=R.f,w=_.J(r.data),GD(w)?R["return"](TE(w)):R["return"](UE(r.data));case 2:if(g!=_.Ge&&g!=_.dc){R.H(4);break}B=[SE(a,m)];c&&B.push(SE(a,c));return _.v(R,Promise.all(B),5);case 5:return E=R.f,F=E[0],D=E[1]||E[0],R["return"](VE(a,F.data,D.data));case 4:if(g!=_.Fe){R.H(6);break}return _.v(R,SE(a,m),7);case 7:return H=R.f,R["return"](UE(H.data));case 6:if(g===_.cc||g===_.bc)return R["return"](0);O=WE;if(!O(g,k))return R["return"](0);throw new _.K(_.L,
4,4030);}})},VE=function(a,b,c){var d=0;(new _.Yj).O(_.td,_.Zj).O(_.se,_.Zj).O(_.pd,_.Zj).ba("mdhd",function(g){g.F.skip(0==g.version?8:16);d=_.Kj(g.F);g.fb.stop()}).parse(c,!0);if(!d)throw a.a.error("Unable to find timescale in init segment!"),new _.K(_.L,4,4030);var e=0,f=!1;(new _.Yj).O("moof",_.Zj).O("traf",_.Zj).ba("tfdt",function(g){e=(0==g.version?_.Kj(g.F):_.Mj(g.F))/d;f=!0;g.fb.stop()}).parse(b,!0);if(!f)throw new _.K(_.L,4,4030);return e},UE=function(a){function b(){d.seek(e+188);f=_.Ij(d);
71!=f&&(d.seek(e+192),f=_.Ij(d));71!=f&&(d.seek(e+204),f=_.Ij(d));71!=f&&c();_.Oj(d)}function c(){throw new _.K(_.L,4,4030);}for(var d=new _.Fj(new DataView(a),!1),e=0,f=0;;)if(e=d.getPosition(),f=_.Ij(d),71!=f&&c(),a=_.Jj(d),8191===(a&8191))b();else if(a&16384)if(a=(_.Ij(d)&48)>>4,0!=a&&2!=a||c(),3==a&&(a=_.Ij(d),d.skip(a)),1!=_.Kj(d)>>8)b();else{d.skip(3);a=_.Ij(d)>>6;0!=a&&1!=a||c();0==_.Ij(d)&&c();a=_.Ij(d);var g=_.Jj(d),k=_.Jj(d);return(1073741824*((a&14)>>1)+((g&65534)<<14|(k&65534)>>1))/9E4}else b()},
TE=function(a){function b(l,m,n){for(var p="";m<n;m++)p+="%"+("00"+l[m].toString(16)).slice(-2);return p}function c(l){return l[0]<<21|l[1]<<14|l[2]<<7|l[3]}function d(){throw new _.K(_.L,4,4030);}GD(a)||d();var e=10;a[5]&64&&(e=e+4+c(a.subarray(10,14)));do{var f=c(a.subarray(e+4,e+8));1>f&&d();var g=String.fromCharCode(a[e],a[e+1],a[e+2],a[e+3]);if("PRIV"===g){g=a.subarray(e+10,e+f+10);for(var k=0;k<g.byteLength;k++)if(0===g[k]){if("com.apple.streaming.transportStreamTimestamp"===unescape(b(g,0,
k)))return a=g.subarray(k+1),f=(a[3]&1)<<30|a[4]<<22|a[5]<<14|a[6]<<6|a[7]>>>2,f*=4,f+=a[7]&3,Math.round(f/9E4);break}}GD(a,e)||d();e+=10;e+=f}while(e<a.byteLength);return d()},kE=function(a,b){for(var c=XE[a],d=0;d<c.length;d++)for(var e=0;e<b.length;e++)if(c[d].test(b[e].trim()))return b[e].trim();return a==_.oe?"":null},lE=function(a,b){if(1==b.length)return b[0];var c=kE(a,b);if(null!=c)return c;throw new _.K(_.L,4,4025,{codecList:b});},yE=function(a,b,c,d){var e,f,g,k,l,m,n,p,q;return _.y(function(r){if(1==
r.a){e=_.hl;f=d.a[0].a;g=new _.Xi(f);k=g.sa.split(".").pop();l=fE[b];if(m=l[k])return r["return"](m);if(b==e.TEXT)return c&&"vtt"!=c?r["return"](_.Rb):r["return"](_.pe);n=_.yh([f],a.h.attemptParameters);n.method="HEAD";n.type=_.Jo;return _.v(r,RE(a,n),2)}p=r.f;q=p.headers["content-type"];if(!q)throw new _.K(_.L,4,4021,k);return r["return"](q.split(";")[0])})},CE=function(a,b){var c=PD(a,b);if(!c)throw new _.K(_.L,4,4024,{missingTag:b});return c},bE=function(a,b){var c=_.yh([b],a.h.attemptParameters);
c.type=1;return RE(a,c)},WE=function(a,b){return MediaSource.isTypeSupported((a.split("/")[0]||"")+'/mp4;codecs\x3d"'+b+'"')},YD=function(a){var b,c,d;_.y(function(e){if(1==e.a){a.a.info(_.mb);if(!a.j)return e["return"]();_.kf(e,2);return _.v(e,a.update(),4)}if(2!=e.a)return b=a.aa,a.A.X(b),_.lf(e,0);c=_.mf(e);a.j&&(a.j.onError(c),d=c,1===d.a&&a.A.X(.1));_.x(e)})},dE=function(a,b){a.m=b;a.g&&(a.g.f=a.m==ZD);a.m!=ZD||a.A.stop()},RE=function(a,b){if(!a.C)throw new _.K(_.L,7,7001);var c=a.j.networkingEngine.fetch(b);
_.sn(a.C,c);return c.promise},YE=function(){};ID.prototype.toString=function(){function a(d){return d.name+"\x3d"+(isNaN(Number(d.value))?'"'+d.value+'"':d.value)}var b="#"+this.name,c=this.attributes?this.attributes.map(a):[];this.value&&c.unshift(this.value);0<c.length&&(b+=":"+c.join(","));return b};ID.prototype.getAttribute=function(a){var b=this.attributes.filter(function(c){return c.name==a});return b.length?b[0]:null};var UD=[BD,yD,wD,zD,"EXT-X-MAP","EXT-X-I-FRAMES-ONLY",xD],VD=["EXTINF",uD,vD,"EXT-X-PROGRAM-DATE-TIME","EXT-X-KEY","EXT-X-DATERANGE"];_.h=$D.prototype;_.h.configure=function(a){this.h=a};_.h.start=function(a,b){var c=this,d,e;return _.y(function(f){if(1==f.a)return c.j=b,_.v(f,bE(c,a),2);if(3!=f.a)return d=f.f,c.B=d.uri,_.v(f,iE(c,d.data),3);e=c.aa;0<e&&c.A.X(e);return f["return"](c.I)})};_.h.stop=function(){this.A&&(this.A.stop(),this.A=null);var a=[];this.C&&(a.push(this.C.destroy()),this.C=null);this.h=this.j=null;this.da.clear();this.f.clear();this.D.clear();this.I=null;this.w.clear();this.o.clear();return Promise.all(a)};
_.h.update=function(){var a=this,b,c,d;return _.y(function(e){if(1==e.a){if(a.m==ZD)return e["return"]();b=[];a.P=null;c=Array.from(a.f.values());return c.length?_.v(e,eE(a,c[0]),2):e.H(2)}for(d=1;d<c.length;++d)b.push(eE(a,c[d]));return _.v(e,Promise.all(b),0)})};_.h.onExpirationUpdated=function(){};
var XE={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},fE={audio:{mp4:_.dc,m4s:_.dc,m4i:_.dc,m4a:_.dc,cmfa:_.dc,ts:_.Fe,aac:_.ac,ec3:_.cc,ac3:_.bc},video:{mp4:_.Ge,m4s:_.Ge,m4i:_.Ge,m4v:_.Ge,cmfv:_.Ge,ts:_.Fe},text:{mp4:_.Rb,m4s:_.Rb,m4i:_.Rb,cmft:_.Rb,vtt:_.pe,ttml:_.Ub}},wE={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(a){var b=LD(a,"METHOD"),c=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];
if(!c.includes(b))return _.Nf("Widevine in HLS is only supported with [",c.join(", "),"], not",b),null;b=LD(a,FD);b=_.Xh.parse(b);b=_.J(b.data);b=_.Pk(_.Jc,[{initDataType:_.qc,initData:b}]);if(a=KD(a,"KEYID"))b.keyIds=[a.substr(2).toLowerCase()];return b}},ZD="VOD",BE="EVENT",AE="LIVE",aE={VOD:ZD,Hk:BE,LIVE:AE};_.u(YE,_.pl);YE.prototype.Ia=function(){_.To.Qd("m3u8",$D);_.To.ed(_.tl,$D);_.To.ed(_.Wb,$D)};YE.prototype.Da=function(){_.To.Te("m3u8");_.To.Rd(_.tl);_.To.Rd(_.Wb)};YE.prototype.id=function(){return"clpp.component.hls"};_.z("clpp.hls.HlsComponent",YE);};
if(typeof(module)!="undefined"&&module.exports){var x=require("./cl.core.min.js");_ = x._;(f.call(g,this));module.exports=g;}
else if (typeof(define)!="undefined"&&define.amd) {define(["./cl.core.min"], function(c){_=c._;(f.call(g,this));return g;});}
else{_=this.clpp._;(f.call(g,this));}
})();
